<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Planificador Espiritual 2026</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body { 
      font-family: 'Georgia', serif; 
      min-height: 100vh; 
      color: #1f2937;
      background-color: #FDF8F5;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5 Q45 30 30 55 Q15 30 30 5' fill='none' stroke='%23F4C430' stroke-width='0.5' opacity='0.15'/%3E%3Cpath d='M5 30 Q30 15 55 30 Q30 45 5 30' fill='none' stroke='%239DD3C9' stroke-width='0.5' opacity='0.15'/%3E%3C/svg%3E");
      background-size: 30px 30px;
    }
    
    .container { max-width: 900px; margin: 0 auto; padding: 20px; }
    
    h1 { font-size: 1.8rem; font-weight: 700; text-align: center; margin-bottom: 4px; color: #E85D4C; }
    .subtitle { color: #6B8EAE; text-align: center; margin-bottom: 24px; font-size: 14px; font-style: italic; }
    
    .status-msg { text-align: center; padding: 10px; margin-bottom: 16px; border-radius: 8px; font-size: 14px; }
    .status-msg.success { background: #D4EDDA; color: #155724; }
    .status-msg.error { background: #F8D7DA; color: #721C24; }
    .status-msg.info { background: #FFF3CD; color: #856404; }
    
    .daily-prayer { background: linear-gradient(135deg, #FFF8E7 0%, #FEFAF5 100%); border-radius: 16px; padding: 20px; margin-bottom: 24px; border: 1px solid #F4C430; text-align: center; }
    .daily-prayer h2 { font-size: 16px; color: #E85D4C; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .daily-prayer p { font-size: 14px; line-height: 1.8; color: #5A5A5A; font-style: italic; }
    .prayer-toggle { background: none; border: none; color: #6B8EAE; cursor: pointer; font-size: 12px; margin-top: 8px; }
    
    .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px; margin-bottom: 24px; }
    .stat { background: white; border-radius: 12px; padding: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06); border: 1px solid #f0f0f0; }
    .stat-num { font-size: 24px; font-weight: 700; }
    .stat-label { font-size: 10px; color: #6b7280; margin-top: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
    .progress-bar { height: 4px; background: #e5e7eb; border-radius: 2px; margin-top: 6px; overflow: hidden; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #9DD3C9, #6B8EAE); border-radius: 2px; }
    
    .tabs { display: flex; gap: 4px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
    .tab { padding: 10px 14px; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 13px; background: #f0f0f0; color: #5A5A5A; transition: all 0.2s; }
    .tab:hover { background: #e0e0e0; }
    .tab.active { background: #9DD3C9; color: #1f2937; }
    
    .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; transition: all 0.2s; }
    .btn-primary { background: #9DD3C9; color: #1f2937; }
    .btn-primary:hover { background: #7CC4B8; }
    .btn-secondary { background: #6B8EAE; color: white; }
    .btn-secondary:hover { background: #5A7D9D; }
    .btn-small { padding: 6px 12px; font-size: 12px; }
    .btn-danger { background: #F8D7DA; color: #721C24; }
    .btn-danger:hover { background: #F1C1C6; }
    
    .card { background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); border-left: 4px solid; overflow: hidden; margin-bottom: 12px; }
    .card-header { padding: 16px; cursor: pointer; display: flex; align-items: center; gap: 12px; }
    .card-header:hover { background: #FEFAF5; }
    .chevron { width: 20px; height: 20px; color: #9ca3af; transition: transform 0.2s; flex-shrink: 0; }
    .card.expanded .chevron { transform: rotate(90deg); }
    .card-body { display: none; border-top: 1px solid #f0f0f0; padding: 16px; }
    .card.expanded .card-body { display: block; }
    
    .lectio-card { border-color: #9DD3C9; }
    .lectio-date { font-size: 14px; color: #2A9D8F; font-weight: 600; }
    .lectio-reading { font-size: 13px; color: #6b7280; margin-top: 4px; }
    .lectio-section { margin-bottom: 16px; }
    .lectio-section-title { font-size: 13px; font-weight: 600; color: #2A9D8F; margin-bottom: 6px; }
    .lectio-textarea { width: 100%; min-height: 80px; padding: 10px; border-radius: 8px; border: 1px solid #e0e0e0; font-size: 14px; font-family: 'Georgia', serif; resize: vertical; line-height: 1.6; }
    .lectio-textarea:focus { outline: none; border-color: #9DD3C9; }
    
    .scripture-display { background: linear-gradient(135deg, #FFF8E7 0%, #FEFAF5 100%); border-radius: 12px; padding: 20px; margin-bottom: 16px; border: 1px solid #F4C430; }
    .scripture-reference { font-size: 16px; color: #E85D4C; font-weight: 600; margin-bottom: 12px; text-align: center; }
    .scripture-text { font-size: 15px; line-height: 2; color: #1f2937; text-align: justify; }
    .scripture-text .verse-num { font-size: 10px; color: #E85D4C; vertical-align: super; margin-right: 3px; font-weight: 700; }
    .scripture-note { font-size: 12px; color: #6b7280; text-align: center; margin-top: 12px; font-style: italic; }
    
    .reading-options { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
    .reading-option { padding: 8px 16px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; font-size: 13px; background: white; transition: all 0.2s; }
    .reading-option:hover { border-color: #9DD3C9; }
    .reading-option.selected { border-color: #2A9D8F; background: #E8F6F3; }
    
    .prayer-card { border-color: #F4C430; }
    .prayer-title { font-size: 16px; font-weight: 600; color: #E85D4C; }
    .prayer-subtitle { font-size: 12px; color: #6b7280; margin-top: 2px; }
    .prayer-content { font-size: 14px; line-height: 1.9; color: #1f2937; }
    .prayer-content p { margin-bottom: 12px; }
    .prayer-content .response { color: #2A9D8F; font-weight: 500; }
    .prayer-content .instruction { color: #6b7280; font-style: italic; font-size: 13px; }
    .prayer-content h4 { color: #E85D4C; font-size: 14px; margin: 16px 0 8px 0; }
    .prayer-content .mystery { background: #FFF8E7; padding: 10px; border-radius: 8px; margin-bottom: 8px; border-left: 3px solid #F4C430; }
    .prayer-content .mystery-title { font-weight: 600; color: #E85D4C; }
    .prayer-content .mystery-fruit { font-size: 12px; color: #6b7280; font-style: italic; }
    
    .intention-category { padding: 12px; background: #FEFAF5; border-radius: 8px; margin-bottom: 10px; }
    .intention-category-title { font-size: 12px; font-weight: 600; color: #E85D4C; margin-bottom: 6px; }
    .intention-list { list-style: none; }
    .intention-item { display: flex; align-items: flex-start; gap: 8px; padding: 6px 0; border-bottom: 1px dashed #F4C430; }
    .intention-item:last-child { border-bottom: none; }
    .intention-check { width: 16px; height: 16px; border-radius: 50%; border: 2px solid #9DD3C9; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px; }
    .intention-check.done { background: #9DD3C9; color: white; font-size: 10px; }
    .intention-text { flex: 1; font-size: 13px; }
    
    .goal-category { padding: 14px; background: #FEFAF5; border-radius: 8px; margin-bottom: 12px; }
    .goal-category.spiritual { border-left: 4px solid #C8A8D3; }
    .goal-category.family { border-left: 4px solid #E8B4B8; }
    .goal-category.personal { border-left: 4px solid #9DD3C9; }
    .goal-category-title { font-size: 13px; font-weight: 600; margin-bottom: 8px; }
    .goal-category.spiritual .goal-category-title { color: #9B59B6; }
    .goal-category.family .goal-category-title { color: #E85D4C; }
    .goal-category.personal .goal-category-title { color: #2A9D8F; }
    .goal-item { display: flex; align-items: flex-start; gap: 10px; padding: 8px 0; border-bottom: 1px solid #f0f0f0; }
    .goal-item:last-child { border-bottom: none; }
    .goal-check { width: 18px; height: 18px; border-radius: 4px; border: 2px solid #9DD3C9; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .goal-check.done { background: #9DD3C9; color: white; }
    .goal-text { flex: 1; font-size: 13px; }
    .goal-text.done { text-decoration: line-through; color: #9ca3af; }
    
    .feast-days { background: white; border-radius: 8px; padding: 12px; margin-bottom: 12px; border: 1px solid #f0f0f0; }
    .feast-day { padding: 6px 0; border-bottom: 1px dashed #f0f0f0; font-size: 13px; }
    .feast-day:last-child { border-bottom: none; }
    .feast-date { color: #E85D4C; font-weight: 600; }
    .feast-solemnity { background: #F4C430; padding: 2px 6px; border-radius: 4px; font-size: 10px; color: #5A5A5A; margin-left: 6px; }
    
    .scripture-box { background: linear-gradient(135deg, #FFF8E7 0%, #FEFAF5 100%); border-radius: 8px; padding: 14px; margin-bottom: 12px; text-align: center; border: 1px solid #F4C430; }
    .scripture-quote { font-size: 15px; font-style: italic; color: #5A5A5A; line-height: 1.6; }
    .scripture-ref { font-size: 12px; color: #E85D4C; margin-top: 6px; }
    
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-top: 12px; }
    .calendar-header { text-align: center; font-size: 11px; font-weight: 600; color: #6b7280; padding: 6px; }
    .calendar-day { text-align: center; padding: 8px 4px; border-radius: 6px; font-size: 13px; cursor: pointer; background: white; border: 1px solid #f0f0f0; }
    .calendar-day:hover { background: #FFF8E7; }
    .calendar-day.today { background: #E85D4C; color: white; border-color: #E85D4C; }
    .calendar-day.has-entry { background: #E8F6F3; border-color: #9DD3C9; }
    .calendar-day.feast { background: #FFF3CD; border-color: #F4C430; }
    .calendar-day.empty { background: transparent; border-color: transparent; cursor: default; }
    
    .form-group { margin-bottom: 14px; }
    .form-label { font-size: 12px; color: #6b7280; margin-bottom: 4px; display: block; }
    .form-select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #e0e0e0; font-size: 14px; background: white; }
    
    .empty-state { text-align: center; padding: 40px; color: #9ca3af; }
    
    .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.4); display: none; align-items: center; justify-content: center; z-index: 100; padding: 20px; }
    .modal.open { display: flex; }
    .modal-box { background: white; border-radius: 16px; padding: 24px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
    .modal-title { font-size: 18px; font-weight: 600; margin-bottom: 20px; color: #1f2937; }
    .modal-close { float: right; background: none; border: none; font-size: 24px; cursor: pointer; color: #9ca3af; }
    
    .export-row { display: flex; gap: 8px; justify-content: center; margin-top: 24px; flex-wrap: wrap; }
    
    .today-lectios { background: #E8F6F3; border-radius: 8px; padding: 12px; margin-bottom: 16px; border: 1px solid #9DD3C9; }
    .today-lectios-title { font-size: 13px; font-weight: 600; color: #2A9D8F; margin-bottom: 8px; }
    .today-lectio-item { font-size: 12px; color: #1f2937; padding: 4px 0; }
    
    .prayer-nav { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 16px; justify-content: center; }
    .prayer-nav-btn { padding: 6px 12px; border: 2px solid #F4C430; border-radius: 20px; background: white; cursor: pointer; font-size: 11px; color: #5A5A5A; transition: all 0.2s; }
    .prayer-nav-btn:hover { background: #FFF8E7; }
    .prayer-nav-btn.active { background: #F4C430; color: #1f2937; border-color: #F4C430; }
    
    .month-goals { background: white; border-radius: 12px; padding: 16px; margin-bottom: 16px; border: 1px solid #f0f0f0; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
    .month-goals h3 { font-size: 15px; color: #E85D4C; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
    .add-goal-row { display: flex; gap: 8px; margin-bottom: 8px; }
    .add-goal-input { flex: 1; padding: 8px 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 13px; }
    .add-goal-input:focus { outline: none; border-color: #9DD3C9; }
    .add-goal-select { padding: 8px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 13px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚úùÔ∏è Mi Planificador Espiritual</h1>
    <p class="subtitle">Compa√±era Diaria de la Mujer Cat√≥lica ‚Ä¢ 2026</p>
    
    <div id="statusMsg" class="status-msg" style="display:none;"></div>
    
    <div class="daily-prayer">
      <h2>üôè Oraci√≥n Diaria a Nuestra Se√±ora</h2>
      <div id="prayerText">
        <p>Madre Sant√≠sima, Se√±ora de mi coraz√≥n,<br>
        hoy me pongo bajo Tu manto de amor y protecci√≥n.<br>
        Te entrego mi d√≠a, con todo lo que trae:<br>
        mis alegr√≠as, mis desaf√≠os, mis miedos y mis esperanzas.</p>
      </div>
      <button class="prayer-toggle" onclick="togglePrayer()">Ver oraci√≥n completa ‚ñº</button>
    </div>
    
    <div class="dashboard" id="dashboard"></div>
    <div class="tabs" id="tabs"></div>
    <div id="content"></div>
    
    <div class="export-row">
      <button class="btn btn-secondary" onclick="exportData()">üíæ Exportar</button>
      <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">üìÇ Importar</button>
      <input type="file" id="importFile" accept=".json" onchange="importData(event)" style="display:none;">
    </div>
  </div>
  
  <div class="modal" id="lectioModal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('lectioModal')">√ó</button>
      <h3 class="modal-title">üìñ Nueva Lectio Divina</h3>
      <div class="form-group">
        <label class="form-label">Selecci√≥n de Lectura</label>
        <div class="reading-options">
          <div class="reading-option selected" onclick="selectReadingType('random')">üé≤ Al Azar</div>
          <div class="reading-option" onclick="selectReadingType('gospel')">üìú Evangelio</div>
          <div class="reading-option" onclick="selectReadingType('psalm')">üéµ Salmo</div>
          <div class="reading-option" onclick="selectReadingType('epistle')">‚úâÔ∏è Ep√≠stola</div>
          <div class="reading-option" onclick="selectReadingType('ot')">üìï AT</div>
          <div class="reading-option" onclick="selectReadingType('manual')">‚úèÔ∏è Elegir</div>
        </div>
      </div>
      <div id="manualSelect" style="display:none;">
        <div class="form-group">
          <label class="form-label">Libro</label>
          <select class="form-select" id="bookSelect" onchange="updateChapters()"></select>
        </div>
        <div class="form-group">
          <label class="form-label">Cap√≠tulo</label>
          <select class="form-select" id="chapterSelect"></select>
        </div>
      </div>
      <div id="selectedReading" style="margin:16px 0;padding:12px;background:#FFF8E7;border-radius:8px;display:none;">
        <span style="font-size:13px;color:#E85D4C;font-weight:600;">Seleccionado: </span>
        <span id="selectedReadingText" style="font-size:13px;color:#5A5A5A;"></span>
      </div>
      <button class="btn btn-primary" style="width:100%;" onclick="startLectio()">Comenzar Lectio Divina</button>
    </div>
  </div>
  
  <div class="modal" id="intentionModal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('intentionModal')">√ó</button>
      <h3 class="modal-title">üíù Nueva Intenci√≥n</h3>
      <div class="form-group">
        <label class="form-label">Categor√≠a</label>
        <select class="form-select" id="intentionCategory">
          <option value="family">Por mi familia y mi hogar</option>
          <option value="spiritual">Por mi vida espiritual</option>
          <option value="others">Por otros</option>
          <option value="thanksgiving">Acci√≥n de Gracias</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Intenci√≥n</label>
        <textarea class="lectio-textarea" id="intentionText" placeholder="Escribe tu intenci√≥n..." rows="3"></textarea>
      </div>
      <button class="btn btn-primary" style="width:100%;" onclick="saveIntention()">Agregar Intenci√≥n</button>
    </div>
  </div>

  <script>
    var chevronSVG = '<svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>';

    var fullPrayer = "Madre Sant√≠sima, Se√±ora de mi coraz√≥n,\nhoy me pongo bajo Tu manto de amor y protecci√≥n.\nTe entrego mi d√≠a, con todo lo que trae:\nmis alegr√≠as, mis desaf√≠os, mis miedos y mis esperanzas.\n\nIntercede por m√≠ ante Tu Hijo Jes√∫s,\npara que viva este d√≠a con fe, paciencia y sabidur√≠a.\nCuando me sienta d√©bil, sost√©nme con Tu ejemplo de valent√≠a.\nCuando no sepa qu√© hacer, ens√©√±ame a escuchar al Esp√≠ritu Santo.\nCuando me pierda entre las preocupaciones, recu√©rdame\nque Dios tiene un plan de amor para m√≠.\n\nMadre, c√∫breme con Tu manto y protege mi hogar,\nmi esposo, mis hijos y todas mis intenciones.\nQue en cada gesto refleje Tu ternura\ny que mi coraz√≥n sea un reflejo del Tuyo:\npuro, confiado y lleno de amor por Dios.\n\nMar√≠a, pasa al frente de todo lo que hoy me preocupa\ny cond√∫ceme por el camino de la voluntad divina.\nBajo Tu mirada, quiero vivir este d√≠a en paz y fidelidad.\n\nAm√©n.";
    
    var prayerExpanded = false;

    // COMPLETE 73-BOOK CATHOLIC BIBLE
    var BIBLE_BOOKS = [
      // PENTATEUCH (5)
      { abbr: 'genesis', name: 'G√©nesis', chapters: 50, type: 'ot' },
      { abbr: 'exodo', name: '√âxodo', chapters: 40, type: 'ot' },
      { abbr: 'levitico', name: 'Lev√≠tico', chapters: 27, type: 'ot' },
      { abbr: 'numeros', name: 'N√∫meros', chapters: 36, type: 'ot' },
      { abbr: 'deuteronomio', name: 'Deuteronomio', chapters: 34, type: 'ot' },
      // HISTORICAL BOOKS (16)
      { abbr: 'josue', name: 'Josu√©', chapters: 24, type: 'ot' },
      { abbr: 'jueces', name: 'Jueces', chapters: 21, type: 'ot' },
      { abbr: 'rut', name: 'Rut', chapters: 4, type: 'ot' },
      { abbr: '1samuel', name: '1 Samuel', chapters: 31, type: 'ot' },
      { abbr: '2samuel', name: '2 Samuel', chapters: 24, type: 'ot' },
      { abbr: '1reyes', name: '1 Reyes', chapters: 22, type: 'ot' },
      { abbr: '2reyes', name: '2 Reyes', chapters: 25, type: 'ot' },
      { abbr: '1cronicas', name: '1 Cr√≥nicas', chapters: 29, type: 'ot' },
      { abbr: '2cronicas', name: '2 Cr√≥nicas', chapters: 36, type: 'ot' },
      { abbr: 'esdras', name: 'Esdras', chapters: 10, type: 'ot' },
      { abbr: 'nehemias', name: 'Nehem√≠as', chapters: 13, type: 'ot' },
      { abbr: 'tobias', name: 'Tob√≠as', chapters: 14, type: 'ot' }, // Deuterocanonical
      { abbr: 'judit', name: 'Judit', chapters: 16, type: 'ot' }, // Deuterocanonical
      { abbr: 'ester', name: 'Ester', chapters: 10, type: 'ot' },
      { abbr: '1macabeos', name: '1 Macabeos', chapters: 16, type: 'ot' }, // Deuterocanonical
      { abbr: '2macabeos', name: '2 Macabeos', chapters: 15, type: 'ot' }, // Deuterocanonical
      // WISDOM BOOKS (7)
      { abbr: 'job', name: 'Job', chapters: 42, type: 'ot' },
      { abbr: 'salmos', name: 'Salmos', chapters: 150, type: 'psalm' },
      { abbr: 'proverbios', name: 'Proverbios', chapters: 31, type: 'ot' },
      { abbr: 'eclesiastes', name: 'Eclesiast√©s', chapters: 12, type: 'ot' },
      { abbr: 'cantar', name: 'Cantar de los Cantares', chapters: 8, type: 'ot' },
      { abbr: 'sabiduria', name: 'Sabidur√≠a', chapters: 19, type: 'ot' }, // Deuterocanonical
      { abbr: 'eclesiastico', name: 'Eclesi√°stico (Sir√°cida)', chapters: 51, type: 'ot' }, // Deuterocanonical
      // MAJOR PROPHETS (6)
      { abbr: 'isaias', name: 'Isa√≠as', chapters: 66, type: 'ot' },
      { abbr: 'jeremias', name: 'Jerem√≠as', chapters: 52, type: 'ot' },
      { abbr: 'lamentaciones', name: 'Lamentaciones', chapters: 5, type: 'ot' },
      { abbr: 'baruc', name: 'Baruc', chapters: 6, type: 'ot' }, // Deuterocanonical
      { abbr: 'ezequiel', name: 'Ezequiel', chapters: 48, type: 'ot' },
      { abbr: 'daniel', name: 'Daniel', chapters: 14, type: 'ot' }, // 14 chapters in Catholic
      // MINOR PROPHETS (12)
      { abbr: 'oseas', name: 'Oseas', chapters: 14, type: 'ot' },
      { abbr: 'joel', name: 'Joel', chapters: 4, type: 'ot' },
      { abbr: 'amos', name: 'Am√≥s', chapters: 9, type: 'ot' },
      { abbr: 'abdias', name: 'Abd√≠as', chapters: 1, type: 'ot' },
      { abbr: 'jonas', name: 'Jon√°s', chapters: 4, type: 'ot' },
      { abbr: 'miqueas', name: 'Miqueas', chapters: 7, type: 'ot' },
      { abbr: 'nahum', name: 'Nah√∫m', chapters: 3, type: 'ot' },
      { abbr: 'habacuc', name: 'Habacuc', chapters: 3, type: 'ot' },
      { abbr: 'sofonias', name: 'Sofon√≠as', chapters: 3, type: 'ot' },
      { abbr: 'ageo', name: 'Ageo', chapters: 2, type: 'ot' },
      { abbr: 'zacarias', name: 'Zacar√≠as', chapters: 14, type: 'ot' },
      { abbr: 'malaquias', name: 'Malaqu√≠as', chapters: 3, type: 'ot' },
      // GOSPELS (4)
      { abbr: 'mateo', name: 'Mateo', chapters: 28, type: 'gospel' },
      { abbr: 'marcos', name: 'Marcos', chapters: 16, type: 'gospel' },
      { abbr: 'lucas', name: 'Lucas', chapters: 24, type: 'gospel' },
      { abbr: 'juan', name: 'Juan', chapters: 21, type: 'gospel' },
      // ACTS
      { abbr: 'hechos', name: 'Hechos de los Ap√≥stoles', chapters: 28, type: 'epistle' },
      // PAULINE EPISTLES (13)
      { abbr: 'romanos', name: 'Romanos', chapters: 16, type: 'epistle' },
      { abbr: '1corintios', name: '1 Corintios', chapters: 16, type: 'epistle' },
      { abbr: '2corintios', name: '2 Corintios', chapters: 13, type: 'epistle' },
      { abbr: 'galatas', name: 'G√°latas', chapters: 6, type: 'epistle' },
      { abbr: 'efesios', name: 'Efesios', chapters: 6, type: 'epistle' },
      { abbr: 'filipenses', name: 'Filipenses', chapters: 4, type: 'epistle' },
      { abbr: 'colosenses', name: 'Colosenses', chapters: 4, type: 'epistle' },
      { abbr: '1tesalonicenses', name: '1 Tesalonicenses', chapters: 5, type: 'epistle' },
      { abbr: '2tesalonicenses', name: '2 Tesalonicenses', chapters: 3, type: 'epistle' },
      { abbr: '1timoteo', name: '1 Timoteo', chapters: 6, type: 'epistle' },
      { abbr: '2timoteo', name: '2 Timoteo', chapters: 4, type: 'epistle' },
      { abbr: 'tito', name: 'Tito', chapters: 3, type: 'epistle' },
      { abbr: 'filemon', name: 'Filem√≥n', chapters: 1, type: 'epistle' },
      // GENERAL EPISTLES (8)
      { abbr: 'hebreos', name: 'Hebreos', chapters: 13, type: 'epistle' },
      { abbr: 'santiago', name: 'Santiago', chapters: 5, type: 'epistle' },
      { abbr: '1pedro', name: '1 Pedro', chapters: 5, type: 'epistle' },
      { abbr: '2pedro', name: '2 Pedro', chapters: 3, type: 'epistle' },
      { abbr: '1juan', name: '1 Juan', chapters: 5, type: 'epistle' },
      { abbr: '2juan', name: '2 Juan', chapters: 1, type: 'epistle' },
      { abbr: '3juan', name: '3 Juan', chapters: 1, type: 'epistle' },
      { abbr: 'judas', name: 'Judas', chapters: 1, type: 'epistle' },
      // REVELATION
      { abbr: 'apocalipsis', name: 'Apocalipsis', chapters: 22, type: 'epistle' }
    ];

    // EMBEDDED SCRIPTURE TEXTS (key passages)
    var BIBLE_TEXT = {
      "genesis-1": "1 En el principio cre√≥ Dios los cielos y la tierra. 2 Y la tierra estaba desordenada y vac√≠a, y las tinieblas estaban sobre la faz del abismo, y el Esp√≠ritu de Dios se mov√≠a sobre la faz de las aguas. 3 Y dijo Dios: Sea la luz; y fue la luz. 4 Y vio Dios que la luz era buena; y separ√≥ Dios la luz de las tinieblas. 26 Entonces dijo Dios: Hagamos al hombre a nuestra imagen, conforme a nuestra semejanza. 27 Y cre√≥ Dios al hombre a su imagen, a imagen de Dios lo cre√≥; var√≥n y hembra los cre√≥. 31 Y vio Dios todo lo que hab√≠a hecho, y he aqu√≠ que era bueno en gran manera.",
      "genesis-12": "1 Pero Jehov√° hab√≠a dicho a Abram: Vete de tu tierra y de tu parentela, y de la casa de tu padre, a la tierra que te mostrar√©. 2 Y har√© de ti una naci√≥n grande, y te bendecir√©, y engrandecer√© tu nombre, y ser√°s bendici√≥n. 3 Bendecir√© a los que te bendijeren, y a los que te maldijeren maldecir√©; y ser√°n benditas en ti todas las familias de la tierra.",
      "exodo-3": "1 Apacentando Mois√©s las ovejas de Jetro su suegro, sacerdote de Madi√°n, llev√≥ las ovejas a trav√©s del desierto, y lleg√≥ hasta Horeb, monte de Dios. 2 Y se le apareci√≥ el √Ångel de Jehov√° en una llama de fuego en medio de una zarza. 4 Viendo Jehov√° que √©l iba a ver, lo llam√≥ Dios de en medio de la zarza, y dijo: ¬°Mois√©s, Mois√©s! Y √©l respondi√≥: Heme aqu√≠. 14 Y respondi√≥ Dios a Mois√©s: YO SOY EL QUE SOY. Y dijo: As√≠ dir√°s a los hijos de Israel: YO SOY me envi√≥ a vosotros.",
      "exodo-20": "1 Y habl√≥ Dios todas estas palabras, diciendo: 2 Yo soy Jehov√° tu Dios, que te saqu√© de la tierra de Egipto, de casa de servidumbre. 3 No tendr√°s dioses ajenos delante de m√≠. 7 No tomar√°s el nombre de Jehov√° tu Dios en vano. 8 Acu√©rdate del d√≠a de reposo para santificarlo. 12 Honra a tu padre y a tu madre. 13 No matar√°s. 14 No cometer√°s adulterio. 15 No hurtar√°s. 16 No hablar√°s contra tu pr√≥jimo falso testimonio. 17 No codiciar√°s.",
      "rut-1": "16 Respondi√≥ Rut: No me ruegues que te deje, y me aparte de ti; porque a dondequiera que t√∫ fueres, ir√© yo, y dondequiera que vivieres, vivir√©. Tu pueblo ser√° mi pueblo, y tu Dios mi Dios. 17 Donde t√∫ murieres, morir√© yo, y all√≠ ser√© sepultada.",
      "1samuel-3": "1 El joven Samuel ministraba a Jehov√° en presencia de El√≠. 4 Jehov√° llam√≥ a Samuel; y √©l respondi√≥: Heme aqu√≠. 9 Dijo El√≠ a Samuel: Ve y acu√©state; y si te llamare, dir√°s: Habla, Jehov√°, porque tu siervo oye. 10 Y vino Jehov√° y se par√≥, y llam√≥ como las otras veces: ¬°Samuel, Samuel! Entonces Samuel dijo: Habla, porque tu siervo oye.",
      "job-1": "21 Y dijo: Desnudo sal√≠ del vientre de mi madre, y desnudo volver√© all√°. Jehov√° dio, y Jehov√° quit√≥; sea el nombre de Jehov√° bendito.",
      "job-42": "1 Respondi√≥ Job a Jehov√°, y dijo: 2 Yo conozco que todo lo puedes, y que no hay pensamiento que se esconda de ti. 5 De o√≠das te hab√≠a o√≠do; mas ahora mis ojos te ven. 6 Por tanto me aborrezco, y me arrepiento en polvo y ceniza.",
      "salmos-1": "1 Bienaventurado el var√≥n que no anduvo en consejo de malos, ni estuvo en camino de pecadores, ni en silla de escarnecedores se ha sentado; 2 sino que en la ley de Jehov√° est√° su delicia, y en su ley medita de d√≠a y de noche. 3 Ser√° como √°rbol plantado junto a corrientes de aguas, que da su fruto en su tiempo, y su hoja no cae; y todo lo que hace, prosperar√°.",
      "salmos-23": "1 Jehov√° es mi pastor; nada me faltar√°. 2 En lugares de delicados pastos me har√° descansar; junto a aguas de reposo me pastorear√°. 3 Confortar√° mi alma; me guiar√° por sendas de justicia por amor de su nombre. 4 Aunque ande en valle de sombra de muerte, no temer√© mal alguno, porque t√∫ estar√°s conmigo; tu vara y tu cayado me infundir√°n aliento. 5 Aderezas mesa delante de m√≠ en presencia de mis angustiadores; unges mi cabeza con aceite; mi copa est√° rebosando. 6 Ciertamente el bien y la misericordia me seguir√°n todos los d√≠as de mi vida, y en la casa de Jehov√° morar√© por largos d√≠as.",
      "salmos-27": "1 Jehov√° es mi luz y mi salvaci√≥n; ¬øde qui√©n temer√©? Jehov√° es la fortaleza de mi vida; ¬øde qui√©n he de atemorizarme? 4 Una cosa he demandado a Jehov√°, √©sta buscar√©; que est√© yo en la casa de Jehov√° todos los d√≠as de mi vida, para contemplar la hermosura de Jehov√°. 14 Aguarda a Jehov√°; esfu√©rzate, y ali√©ntese tu coraz√≥n; s√≠, espera a Jehov√°.",
      "salmos-42": "1 Como el ciervo brama por las corrientes de las aguas, as√≠ clama por ti, oh Dios, el alma m√≠a. 2 Mi alma tiene sed de Dios, del Dios vivo. 5 ¬øPor qu√© te abates, oh alma m√≠a, y te turbas dentro de m√≠? Espera en Dios; porque a√∫n he de alabarle.",
      "salmos-51": "1 Ten piedad de m√≠, oh Dios, conforme a tu misericordia; conforme a la multitud de tus piedades borra mis rebeliones. 2 L√°vame m√°s y m√°s de mi maldad, y l√≠mpiame de mi pecado. 10 Crea en m√≠, oh Dios, un coraz√≥n limpio, y renueva un esp√≠ritu recto dentro de m√≠. 12 Vu√©lveme el gozo de tu salvaci√≥n.",
      "salmos-63": "1 Dios, Dios m√≠o eres t√∫; de madrugada te buscar√©; mi alma tiene sed de ti. 3 Porque mejor es tu misericordia que la vida; mis labios te alabar√°n.",
      "salmos-91": "1 El que habita al abrigo del Alt√≠simo morar√° bajo la sombra del Omnipotente. 2 Dir√© yo a Jehov√°: Esperanza m√≠a, y castillo m√≠o; mi Dios, en quien confiar√©. 4 Con sus plumas te cubrir√°, y debajo de sus alas estar√°s seguro. 11 Pues a sus √°ngeles mandar√° acerca de ti, que te guarden en todos tus caminos.",
      "salmos-103": "1 Bendice, alma m√≠a, a Jehov√°, y bendiga todo mi ser su santo nombre. 2 Bendice, alma m√≠a, a Jehov√°, y no olvides ninguno de sus beneficios. 3 El es quien perdona todas tus iniquidades, el que sana todas tus dolencias. 8 Misericordioso y clemente es Jehov√°; lento para la ira, y grande en misericordia. 12 Cuanto est√° lejos el oriente del occidente, hizo alejar de nosotros nuestras rebeliones.",
      "salmos-139": "1 Oh Jehov√°, t√∫ me has examinado y conocido. 2 T√∫ has conocido mi sentarme y mi levantarme; has entendido desde lejos mis pensamientos. 7 ¬øA d√≥nde me ir√© de tu Esp√≠ritu? ¬øY a d√≥nde huir√© de tu presencia? 14 Te alabar√©; porque formidables, maravillosas son tus obras. 23 Exam√≠name, oh Dios, y conoce mi coraz√≥n; pru√©bame y conoce mis pensamientos.",
      "salmos-150": "1 ¬°Aleluya! Alabad a Dios en su santuario; alabadle en la magnificencia de su firmamento. 6 Todo lo que respira alabe a Jehov√°. ¬°Aleluya!",
      "proverbios-3": "5 F√≠ate de Jehov√° de todo tu coraz√≥n, y no te apoyes en tu propia prudencia. 6 Recon√≥celo en todos tus caminos, y √©l enderezar√° tus veredas.",
      "proverbios-31": "10 Mujer virtuosa, ¬øqui√©n la hallar√°? Porque su estima sobrepasa largamente a la de las piedras preciosas. 25 Fuerza y honor son su vestidura; y se r√≠e de lo por venir. 26 Abre su boca con sabidur√≠a, y la ley de clemencia est√° en su lengua. 30 Enga√±osa es la gracia, y vana la hermosura; la mujer que teme a Jehov√°, √©sa ser√° alabada.",
      "eclesiastes-3": "1 Todo tiene su tiempo, y todo lo que se quiere debajo del cielo tiene su hora. 2 Tiempo de nacer, y tiempo de morir; tiempo de plantar, y tiempo de arrancar lo plantado. 4 Tiempo de llorar, y tiempo de re√≠r; tiempo de endechar, y tiempo de bailar. 11 Todo lo hizo hermoso en su tiempo.",
      "cantar-2": "10 Mi amado habl√≥, y me dijo: Lev√°ntate, oh amiga m√≠a, hermosa m√≠a, y ven. 11 Porque he aqu√≠ ha pasado el invierno, se ha mudado, la lluvia se fue. 12 Se han mostrado las flores en la tierra, el tiempo de la canci√≥n ha venido.",
      "sabiduria-3": "1 Pero las almas de los justos est√°n en la mano de Dios y no les alcanzar√° tormento alguno. 2 A los ojos de los insensatos pareci√≥ que mor√≠an, y su tr√°nsito fue considerado aflicci√≥n. 3 Pero ellos est√°n en paz.",
      "eclesiastico-2": "1 Hijo, si te acercas a servir al Se√±or, prepara tu alma para la prueba. 4 Acepta todo lo que te sobrevenga, y s√© sufrido en las vicisitudes de tu humillaci√≥n. 6 Conf√≠a en √©l, y √©l te ayudar√°; endereza tus caminos y espera en √©l.",
      "isaias-6": "1 En el a√±o que muri√≥ el rey Uz√≠as vi yo al Se√±or sentado sobre un trono alto y sublime, y sus faldas llenaban el templo. 3 Y el uno al otro daba voces, diciendo: Santo, santo, santo, Jehov√° de los ej√©rcitos; toda la tierra est√° llena de su gloria. 8 Despu√©s o√≠ la voz del Se√±or, que dec√≠a: ¬øA qui√©n enviar√©, y qui√©n ir√° por nosotros? Entonces respond√≠ yo: Heme aqu√≠, env√≠ame a m√≠.",
      "isaias-40": "28 ¬øNo has sabido, no has o√≠do que el Dios eterno es Jehov√°, el cual cre√≥ los confines de la tierra? No desfallece, ni se fatiga con cansancio, y su entendimiento no hay quien lo alcance. 29 El da esfuerzo al cansado, y multiplica las fuerzas al que no tiene ningunas. 31 pero los que esperan a Jehov√° tendr√°n nuevas fuerzas; levantar√°n alas como las √°guilas; correr√°n, y no se cansar√°n; caminar√°n, y no se fatigar√°n.",
      "isaias-53": "3 Despreciado y desechado entre los hombres, var√≥n de dolores, experimentado en quebranto. 4 Ciertamente llev√≥ √©l nuestras enfermedades, y sufri√≥ nuestros dolores. 5 Mas √©l herido fue por nuestras rebeliones, molido por nuestros pecados; el castigo de nuestra paz fue sobre √©l, y por su llaga fuimos nosotros curados.",
      "jeremias-29": "11 Porque yo s√© los pensamientos que tengo acerca de vosotros, dice Jehov√°, pensamientos de paz, y no de mal, para daros el fin que esper√°is. 12 Entonces me invocar√©is, y vendr√©is y orar√©is a m√≠, y yo os oir√©. 13 y me buscar√©is y me hallar√©is, porque me buscar√©is de todo vuestro coraz√≥n.",
      "lamentaciones-3": "22 Por la misericordia de Jehov√° no hemos sido consumidos, porque nunca decayeron sus misericordias. 23 Nuevas son cada ma√±ana; grande es tu fidelidad. 24 Mi porci√≥n es Jehov√°, dijo mi alma; por tanto, en √©l esperar√©.",
      "ezequiel-37": "1 La mano de Jehov√° vino sobre m√≠, y me llev√≥ en el Esp√≠ritu de Jehov√°, y me puso en medio de un valle que estaba lleno de huesos. 3 Y me dijo: Hijo de hombre, ¬øvivir√°n estos huesos? Y dije: Se√±or Jehov√°, t√∫ lo sabes. 5 As√≠ ha dicho Jehov√° el Se√±or a estos huesos: He aqu√≠, yo hago entrar esp√≠ritu en vosotros, y vivir√©is.",
      "daniel-3": "17 He aqu√≠ nuestro Dios a quien servimos puede librarnos del horno de fuego ardiendo; y de tu mano, oh rey, nos librar√°. 18 Y si no, sepas, oh rey, que no serviremos a tus dioses, ni tampoco adoraremos la estatua que has levantado.",
      "oseas-6": "1 Venid y volvamos a Jehov√°; porque √©l arrebat√≥, y nos curar√°; hiri√≥, y nos vendar√°. 3 Y conoceremos, y proseguiremos en conocer a Jehov√°; como el alba est√° dispuesta su salida, y vendr√° a nosotros como la lluvia, como la lluvia tard√≠a y temprana a la tierra.",
      "miqueas-6": "8 Oh hombre, √©l te ha declarado lo que es bueno, y qu√© pide Jehov√° de ti: solamente hacer justicia, y amar misericordia, y humillarte ante tu Dios.",
      "tobias-4": "15 No hagas a nadie lo que no quieras que te hagan a ti. 19 Bendice al Se√±or tu Dios en todo momento, p√≠dele que dirija tu camino.",
      "judit-13": "18 Bendita seas t√∫, hija, por el Dios Alt√≠simo, m√°s que todas las mujeres de la tierra; y bendito sea el Se√±or Dios.",
      "mateo-1": "18 El nacimiento de Jesucristo fue as√≠: Su madre Mar√≠a estaba desposada con Jos√©; y antes de que vivieran juntos, se hall√≥ que hab√≠a concebido del Esp√≠ritu Santo. 21 Y dar√° a luz un hijo, y llamar√°s su nombre Jes√∫s, porque √©l salvar√° a su pueblo de sus pecados. 23 He aqu√≠, una virgen concebir√° y dar√° a luz un hijo, y llamar√°s su nombre Emanuel, que traducido es: Dios con nosotros.",
      "mateo-5": "1 Viendo las multitudes, subi√≥ al monte; y cuando se sent√≥, se le acercaron sus disc√≠pulos. 3 Bienaventurados los pobres en esp√≠ritu, porque de ellos es el reino de los cielos. 4 Bienaventurados los que lloran, porque ellos ser√°n consolados. 5 Bienaventurados los mansos, porque ellos heredar√°n la tierra. 6 Bienaventurados los que tienen hambre y sed de justicia, porque ellos ser√°n saciados. 7 Bienaventurados los misericordiosos, porque ellos alcanzar√°n misericordia. 8 Bienaventurados los de limpio coraz√≥n, porque ellos ver√°n a Dios. 9 Bienaventurados los pacificadores, porque ellos ser√°n llamados hijos de Dios. 14 Vosotros sois la luz del mundo.",
      "mateo-6": "9 Vosotros, pues, orar√©is as√≠: Padre nuestro que est√°s en los cielos, santificado sea tu nombre. 10 Venga tu reino. H√°gase tu voluntad, como en el cielo, as√≠ tambi√©n en la tierra. 11 El pan nuestro de cada d√≠a, d√°noslo hoy. 12 Y perd√≥nanos nuestras deudas, como tambi√©n nosotros perdonamos a nuestros deudores. 33 Mas buscad primeramente el reino de Dios y su justicia, y todas estas cosas os ser√°n a√±adidas.",
      "mateo-7": "7 Pedid, y se os dar√°; buscad, y hallar√©is; llamad, y se os abrir√°. 12 As√≠ que, todas las cosas que quer√°is que los hombres hagan con vosotros, as√≠ tambi√©n haced vosotros con ellos.",
      "mateo-11": "28 Venid a m√≠ todos los que est√°is trabajados y cargados, y yo os har√© descansar. 29 Llevad mi yugo sobre vosotros, y aprended de m√≠, que soy manso y humilde de coraz√≥n; y hallar√©is descanso para vuestras almas. 30 Porque mi yugo es f√°cil, y ligera mi carga.",
      "mateo-28": "18 Y Jes√∫s se acerc√≥ y les habl√≥ diciendo: Toda potestad me es dada en el cielo y en la tierra. 19 Por tanto, id, y haced disc√≠pulos a todas las naciones, bautiz√°ndolos en el nombre del Padre, y del Hijo, y del Esp√≠ritu Santo. 20 ense√±√°ndoles que guarden todas las cosas que os he mandado; y he aqu√≠ yo estoy con vosotros todos los d√≠as, hasta el fin del mundo.",
      "marcos-1": "1 Principio del evangelio de Jesucristo, Hijo de Dios. 9 Aconteci√≥ en aquellos d√≠as, que Jes√∫s vino de Nazaret de Galilea, y fue bautizado por Juan en el Jord√°n. 10 Y luego, cuando sub√≠a del agua, vio abrirse los cielos, y al Esp√≠ritu como paloma que descend√≠a sobre √©l. 11 Y vino una voz de los cielos que dec√≠a: T√∫ eres mi Hijo amado; en ti tengo complacencia. 15 diciendo: El tiempo se ha cumplido, y el reino de Dios se ha acercado; arrepent√≠os, y creed en el evangelio.",
      "marcos-10": "45 Porque el Hijo del Hombre no vino para ser servido, sino para servir, y para dar su vida en rescate por muchos.",
      "lucas-1": "26 Al sexto mes el √°ngel Gabriel fue enviado por Dios a una ciudad de Galilea, llamada Nazaret, 27 a una virgen desposada con un var√≥n que se llamaba Jos√©, de la casa de David; y el nombre de la virgen era Mar√≠a. 28 Y entrando el √°ngel en donde ella estaba, dijo: ¬°Salve, muy favorecida! El Se√±or es contigo; bendita t√∫ entre las mujeres. 38 Entonces Mar√≠a dijo: He aqu√≠ la sierva del Se√±or; h√°gase conmigo conforme a tu palabra. 46 Entonces Mar√≠a dijo: Engrandece mi alma al Se√±or; 47 Y mi esp√≠ritu se regocija en Dios mi Salvador.",
      "lucas-2": "7 Y dio a luz a su hijo primog√©nito, y lo envolvi√≥ en pa√±ales, y lo acost√≥ en un pesebre, porque no hab√≠a lugar para ellos en el mes√≥n. 10 Pero el √°ngel les dijo: No tem√°is; porque he aqu√≠ os doy nuevas de gran gozo. 11 que os ha nacido hoy, en la ciudad de David, un Salvador, que es Cristo el Se√±or. 14 ¬°Gloria a Dios en las alturas, y en la tierra paz, buena voluntad para con los hombres! 19 Pero Mar√≠a guardaba todas estas cosas, medit√°ndolas en su coraz√≥n.",
      "lucas-10": "27 Aqu√©l, respondiendo, dijo: Amar√°s al Se√±or tu Dios con todo tu coraz√≥n, y con toda tu alma, y con todas tus fuerzas, y con toda tu mente; y a tu pr√≥jimo como a ti mismo.",
      "lucas-15": "4 ¬øQu√© hombre de vosotros, teniendo cien ovejas, si pierde una de ellas, no deja las noventa y nueve en el desierto, y va tras la que se perdi√≥, hasta encontrarla? 7 Os digo que as√≠ habr√° m√°s gozo en el cielo por un pecador que se arrepiente. 20 Y levant√°ndose, vino a su padre. Y cuando a√∫n estaba lejos, lo vio su padre, y fue movido a misericordia, y corri√≥, y se ech√≥ sobre su cuello, y le bes√≥.",
      "juan-1": "1 En el principio era el Verbo, y el Verbo era con Dios, y el Verbo era Dios. 4 En √©l estaba la vida, y la vida era la luz de los hombres. 14 Y aquel Verbo fue hecho carne, y habit√≥ entre nosotros, y vimos su gloria, gloria como del unig√©nito del Padre, lleno de gracia y de verdad.",
      "juan-3": "16 Porque de tal manera am√≥ Dios al mundo, que ha dado a su Hijo unig√©nito, para que todo aquel que en √©l cree, no se pierda, mas tenga vida eterna. 17 Porque no envi√≥ Dios a su Hijo al mundo para condenar al mundo, sino para que el mundo sea salvo por √©l.",
      "juan-6": "35 Jes√∫s les dijo: Yo soy el pan de vida; el que a m√≠ viene, nunca tendr√° hambre; y el que en m√≠ cree, no tendr√° sed jam√°s.",
      "juan-8": "12 Otra vez Jes√∫s les habl√≥, diciendo: Yo soy la luz del mundo; el que me sigue, no andar√° en tinieblas, sino que tendr√° la luz de la vida. 32 y conocer√©is la verdad, y la verdad os har√° libres.",
      "juan-10": "10 Yo he venido para que tengan vida, y para que la tengan en abundancia. 11 Yo soy el buen pastor; el buen pastor su vida da por las ovejas.",
      "juan-11": "25 Le dijo Jes√∫s: Yo soy la resurrecci√≥n y la vida; el que cree en m√≠, aunque est√© muerto, vivir√°. 26 Y todo aquel que vive y cree en m√≠, no morir√° eternamente.",
      "juan-14": "1 No se turbe vuestro coraz√≥n; cre√©is en Dios, creed tambi√©n en m√≠. 2 En la casa de mi Padre muchas moradas hay. 6 Jes√∫s le dijo: Yo soy el camino, y la verdad, y la vida; nadie viene al Padre, sino por m√≠. 27 La paz os dejo, mi paz os doy; yo no os la doy como el mundo la da. No se turbe vuestro coraz√≥n, ni tenga miedo.",
      "juan-15": "1 Yo soy la vid verdadera, y mi Padre es el labrador. 5 Yo soy la vid, vosotros los p√°mpanos; el que permanece en m√≠, y yo en √©l, √©ste lleva mucho fruto; porque separados de m√≠ nada pod√©is hacer. 9 Como el Padre me ha amado, as√≠ tambi√©n yo os he amado; permaneced en mi amor. 12 Este es mi mandamiento: Que os am√©is unos a otros, como yo os he amado. 13 Nadie tiene mayor amor que este, que uno ponga su vida por sus amigos.",
      "hechos-2": "1 Cuando lleg√≥ el d√≠a de Pentecost√©s, estaban todos un√°nimes juntos. 2 Y de repente vino del cielo un estruendo como de un viento recio que soplaba. 4 Y fueron todos llenos del Esp√≠ritu Santo.",
      "romanos-5": "1 Justificados, pues, por la fe, tenemos paz para con Dios por medio de nuestro Se√±or Jesucristo. 8 Mas Dios muestra su amor para con nosotros, en que siendo a√∫n pecadores, Cristo muri√≥ por nosotros.",
      "romanos-8": "1 Ahora, pues, ninguna condenaci√≥n hay para los que est√°n en Cristo Jes√∫s. 28 Y sabemos que a los que aman a Dios, todas las cosas les ayudan a bien. 31 ¬øQu√©, pues, diremos a esto? Si Dios es por nosotros, ¬øqui√©n contra nosotros? 35 ¬øQui√©n nos separar√° del amor de Cristo? 37 Antes, en todas estas cosas somos m√°s que vencedores por medio de aquel que nos am√≥. 38 Por lo cual estoy seguro de que ni la muerte, ni la vida, ni √°ngeles, ni principados, ni lo presente, ni lo por venir, 39 ni lo alto, ni lo profundo, ni ninguna otra cosa creada nos podr√° separar del amor de Dios, que es en Cristo Jes√∫s Se√±or nuestro.",
      "romanos-12": "1 As√≠ que, hermanos, os ruego por las misericordias de Dios, que present√©is vuestros cuerpos en sacrificio vivo, santo, agradable a Dios. 2 No os conform√©is a este siglo, sino transformaos por medio de la renovaci√≥n de vuestro entendimiento. 9 El amor sea sin fingimiento. Aborreced lo malo, seguid lo bueno. 21 No seas vencido de lo malo, sino vence con el bien el mal.",
      "1corintios-13": "1 Si yo hablase lenguas humanas y ang√©licas, y no tengo amor, vengo a ser como metal que resuena. 4 El amor es sufrido, es benigno; el amor no tiene envidia, el amor no es jactancioso, no se envanece. 7 Todo lo sufre, todo lo cree, todo lo espera, todo lo soporta. 8 El amor nunca deja de ser. 13 Y ahora permanecen la fe, la esperanza y el amor, estos tres; pero el mayor de ellos es el amor.",
      "2corintios-4": "7 Pero tenemos este tesoro en vasos de barro, para que la excelencia del poder sea de Dios, y no de nosotros. 16 Por tanto, no desmayamos; antes aunque este nuestro hombre exterior se va desgastando, el interior no obstante se renueva de d√≠a en d√≠a. 17 Porque esta leve tribulaci√≥n moment√°nea produce en nosotros un cada vez m√°s excelente y eterno peso de gloria.",
      "2corintios-12": "9 Y me ha dicho: B√°state mi gracia; porque mi poder se perfecciona en la debilidad. Por tanto, de buena gana me gloriar√© m√°s bien en mis debilidades, para que repose sobre m√≠ el poder de Cristo.",
      "galatas-2": "20 Con Cristo estoy juntamente crucificado, y ya no vivo yo, mas vive Cristo en m√≠; y lo que ahora vivo en la carne, lo vivo en la fe del Hijo de Dios, el cual me am√≥ y se entreg√≥ a s√≠ mismo por m√≠.",
      "galatas-5": "22 Mas el fruto del Esp√≠ritu es amor, gozo, paz, paciencia, benignidad, bondad, fe, 23 mansedumbre, templanza; contra tales cosas no hay ley.",
      "efesios-2": "8 Porque por gracia sois salvos por medio de la fe; y esto no de vosotros, pues es don de Dios. 10 Porque somos hechura suya, creados en Cristo Jes√∫s para buenas obras.",
      "efesios-3": "20 Y a Aquel que es poderoso para hacer todas las cosas mucho m√°s abundantemente de lo que pedimos o entendemos, seg√∫n el poder que act√∫a en nosotros.",
      "efesios-6": "10 Por lo dem√°s, hermanos m√≠os, fortaleceos en el Se√±or, y en el poder de su fuerza. 11 Vest√≠os de toda la armadura de Dios, para que pod√°is estar firmes contra las asechanzas del diablo.",
      "filipenses-1": "6 estando persuadido de esto, que el que comenz√≥ en vosotros la buena obra, la perfeccionar√° hasta el d√≠a de Jesucristo.",
      "filipenses-2": "5 Haya, pues, en vosotros este sentir que hubo tambi√©n en Cristo Jes√∫s, 10 para que en el nombre de Jes√∫s se doble toda rodilla. 13 porque Dios es el que en vosotros produce as√≠ el querer como el hacer, por su buena voluntad.",
      "filipenses-4": "4 Regocijaos en el Se√±or siempre. Otra vez digo: ¬°Regocijaos! 6 Por nada est√©is afanosos, sino sean conocidas vuestras peticiones delante de Dios en toda oraci√≥n y ruego, con acci√≥n de gracias. 7 Y la paz de Dios, que sobrepasa todo entendimiento, guardar√° vuestros corazones y vuestros pensamientos en Cristo Jes√∫s. 8 Por lo dem√°s, hermanos, todo lo que es verdadero, todo lo honesto, todo lo justo, todo lo puro, todo lo amable, todo lo que es de buen nombre; si hay virtud alguna, si algo digno de alabanza, en esto pensad. 13 Todo lo puedo en Cristo que me fortalece.",
      "colosenses-3": "1 Si, pues, hab√©is resucitado con Cristo, buscad las cosas de arriba, donde est√° Cristo sentado a la diestra de Dios. 2 Poned la mira en las cosas de arriba, no en las de la tierra. 12 Vest√≠os, pues, como escogidos de Dios, santos y amados, de entra√±able misericordia, de benignidad, de humildad, de mansedumbre, de paciencia. 14 Y sobre todas estas cosas vest√≠os de amor, que es el v√≠nculo perfecto.",
      "1tesalonicenses-5": "16 Estad siempre gozosos. 17 Orad sin cesar. 18 Dad gracias en todo, porque esta es la voluntad de Dios para con vosotros en Cristo Jes√∫s.",
      "hebreos-11": "1 Es, pues, la fe la certeza de lo que se espera, la convicci√≥n de lo que no se ve. 6 Pero sin fe es imposible agradar a Dios; porque es necesario que el que se acerca a Dios crea que le hay, y que es galardonador de los que le buscan.",
      "hebreos-12": "1 Por tanto, nosotros tambi√©n, teniendo en derredor nuestro tan grande nube de testigos, despoj√©monos de todo peso y del pecado que nos asedia, y corramos con paciencia la carrera que tenemos por delante. 2 puestos los ojos en Jes√∫s, el autor y consumador de la fe.",
      "santiago-1": "2 Hermanos m√≠os, tened por sumo gozo cuando os hall√©is en diversas pruebas, 5 Y si alguno de vosotros tiene falta de sabidur√≠a, p√≠dala a Dios, el cual da a todos abundantemente y sin reproche, y le ser√° dada. 17 Toda buena d√°diva y todo don perfecto desciende de lo alto, del Padre de las luces.",
      "1pedro-5": "7 echando toda vuestra ansiedad sobre √©l, porque √©l tiene cuidado de vosotros.",
      "1juan-4": "7 Amados, am√©monos unos a otros; porque el amor es de Dios. Todo aquel que ama, es nacido de Dios, y conoce a Dios. 8 El que no ama, no ha conocido a Dios; porque Dios es amor. 16 Y nosotros hemos conocido y cre√≠do el amor que Dios tiene para con nosotros. Dios es amor; y el que permanece en amor, permanece en Dios, y Dios en √©l. 18 En el amor no hay temor, sino que el perfecto amor echa fuera el temor.",
      "apocalipsis-21": "1 Vi un cielo nuevo y una tierra nueva; porque el primer cielo y la primera tierra pasaron. 3 Y o√≠ una gran voz del cielo que dec√≠a: He aqu√≠ el tabern√°culo de Dios con los hombres, y √©l morar√° con ellos. 4 Enjugar√° Dios toda l√°grima de los ojos de ellos; y ya no habr√° muerte, ni habr√° m√°s llanto, ni clamor, ni dolor; porque las primeras cosas pasaron. 5 Y el que estaba sentado en el trono dijo: He aqu√≠, yo hago nuevas todas las cosas."
    };

    // PRAYERS IN SPANISH
    var PRAYERS = {
      rosary_joyful: { title: "Misterios Gozosos", subtitle: "Lunes y S√°bado", content: '<p class="instruction">Se rezan los lunes y s√°bados</p><div class="mystery"><div class="mystery-title">1¬∫ La Anunciaci√≥n</div><p>"H√°gase en m√≠ seg√∫n tu palabra." (Lc 1,38)</p><p class="mystery-fruit">Fruto: Humildad</p></div><div class="mystery"><div class="mystery-title">2¬∫ La Visitaci√≥n</div><p>"Bendita t√∫ entre las mujeres." (Lc 1,42)</p><p class="mystery-fruit">Fruto: Amor al Pr√≥jimo</p></div><div class="mystery"><div class="mystery-title">3¬∫ El Nacimiento</div><p>"Dio a luz a su hijo primog√©nito." (Lc 2,7)</p><p class="mystery-fruit">Fruto: Desprendimiento</p></div><div class="mystery"><div class="mystery-title">4¬∫ La Presentaci√≥n</div><p>"Luz para iluminar a las naciones." (Lc 2,32)</p><p class="mystery-fruit">Fruto: Obediencia</p></div><div class="mystery"><div class="mystery-title">5¬∫ El Ni√±o Perdido y Hallado</div><p>"Debo ocuparme de las cosas de mi Padre." (Lc 2,49)</p><p class="mystery-fruit">Fruto: Gozo de Encontrar a Jes√∫s</p></div>' },
      rosary_sorrowful: { title: "Misterios Dolorosos", subtitle: "Martes y Viernes", content: '<p class="instruction">Se rezan los martes y viernes</p><div class="mystery"><div class="mystery-title">1¬∫ La Oraci√≥n en el Huerto</div><p>"No se haga mi voluntad, sino la tuya." (Lc 22,42)</p><p class="mystery-fruit">Fruto: Dolor por los Pecados</p></div><div class="mystery"><div class="mystery-title">2¬∫ La Flagelaci√≥n</div><p>"Pilato mand√≥ azotarlo." (Jn 19,1)</p><p class="mystery-fruit">Fruto: Mortificaci√≥n</p></div><div class="mystery"><div class="mystery-title">3¬∫ La Coronaci√≥n de Espinas</div><p>"Trenzaron una corona de espinas." (Mt 27,29)</p><p class="mystery-fruit">Fruto: Desprecio del Mundo</p></div><div class="mystery"><div class="mystery-title">4¬∫ La Cruz a Cuestas</div><p>"Cargando con su cruz, sali√≥." (Jn 19,17)</p><p class="mystery-fruit">Fruto: Paciencia</p></div><div class="mystery"><div class="mystery-title">5¬∫ La Crucifixi√≥n</div><p>"Padre, en tus manos encomiendo mi esp√≠ritu." (Lc 23,46)</p><p class="mystery-fruit">Fruto: Conversi√≥n</p></div>' },
      rosary_glorious: { title: "Misterios Gloriosos", subtitle: "Mi√©rcoles y Domingo", content: '<div class="mystery"><div class="mystery-title">1¬∫ La Resurrecci√≥n</div><p>"No est√° aqu√≠, ha resucitado." (Mt 28,6)</p><p class="mystery-fruit">Fruto: Fe</p></div><div class="mystery"><div class="mystery-title">2¬∫ La Ascensi√≥n</div><p>"Fue llevado al cielo." (Mc 16,19)</p><p class="mystery-fruit">Fruto: Esperanza</p></div><div class="mystery"><div class="mystery-title">3¬∫ Pentecost√©s</div><p>"Quedaron todos llenos del Esp√≠ritu Santo." (Hch 2,4)</p><p class="mystery-fruit">Fruto: Amor de Dios</p></div><div class="mystery"><div class="mystery-title">4¬∫ La Asunci√≥n de Mar√≠a</div><p>"Proclama mi alma la grandeza del Se√±or." (Lc 1,46)</p><p class="mystery-fruit">Fruto: Buena Muerte</p></div><div class="mystery"><div class="mystery-title">5¬∫ Coronaci√≥n de Mar√≠a</div><p>"Una Mujer vestida del sol." (Ap 12,1)</p><p class="mystery-fruit">Fruto: Confianza en Mar√≠a</p></div>' },
      rosary_luminous: { title: "Misterios Luminosos", subtitle: "Jueves", content: '<div class="mystery"><div class="mystery-title">1¬∫ El Bautismo de Jes√∫s</div><p>"T√∫ eres mi Hijo amado." (Lc 3,22)</p><p class="mystery-fruit">Fruto: Apertura al Esp√≠ritu</p></div><div class="mystery"><div class="mystery-title">2¬∫ Las Bodas de Can√°</div><p>"Haced lo que √âl os diga." (Jn 2,5)</p><p class="mystery-fruit">Fruto: Fidelidad</p></div><div class="mystery"><div class="mystery-title">3¬∫ El Anuncio del Reino</div><p>"Convert√≠os y creed." (Mc 1,15)</p><p class="mystery-fruit">Fruto: Conversi√≥n</p></div><div class="mystery"><div class="mystery-title">4¬∫ La Transfiguraci√≥n</div><p>"Su rostro resplandeci√≥ como el sol." (Mt 17,2)</p><p class="mystery-fruit">Fruto: Valor Espiritual</p></div><div class="mystery"><div class="mystery-title">5¬∫ La Eucarist√≠a</div><p>"Esto es mi Cuerpo." (Lc 22,19)</p><p class="mystery-fruit">Fruto: Adoraci√≥n</p></div>' },
      anima_christi: { title: "Anima Christi", subtitle: "Alma de Cristo", content: '<p>Alma de Cristo, santif√≠came.<br>Cuerpo de Cristo, s√°lvame.<br>Sangre de Cristo, embri√°game.<br>Agua del costado de Cristo, l√°vame.<br>Pasi√≥n de Cristo, conf√≥rtame.<br>Oh buen Jes√∫s, √≥yeme.<br>Dentro de tus llagas, esc√≥ndeme.<br>No permitas que me aparte de Ti.<br>Del enemigo, defi√©ndeme.<br>En la hora de mi muerte, ll√°mame.<br>Y m√°ndame ir a Ti,<br>Para que con tus Santos te alabe<br>Por los siglos de los siglos. <strong>Am√©n.</strong></p>' },
      divine_mercy: { title: "Coronilla de la Divina Misericordia", subtitle: "", content: '<h4>Oraci√≥n Inicial</h4><p><strong>Padre Eterno, te ofrezco el Cuerpo y la Sangre, el Alma y la Divinidad de tu Amad√≠simo Hijo, nuestro Se√±or Jesucristo, como propiciaci√≥n de nuestros pecados y los del mundo entero.</strong></p><h4>En cada decena (10 veces):</h4><p><strong>Por Su dolorosa Pasi√≥n, ten misericordia de nosotros y del mundo entero.</strong></p><h4>Al final (3 veces):</h4><p><strong>Santo Dios, Santo Fuerte, Santo Inmortal, ten piedad de nosotros y del mundo entero.</strong></p>' }
    };
    
    // 2026 CALENDAR
    var MONTHS = [
      { name: 'Enero', theme: 'Nombre de Jes√∫s', scripture: '"Al nombre de Jes√∫s toda rodilla se doble."', ref: 'Filipenses 2:10', feasts: [{ date: '1', name: 'Santa Mar√≠a, Madre de Dios', solemnity: true }, { date: '6', name: 'Epifan√≠a', solemnity: true }]},
      { name: 'Febrero', theme: 'Conversi√≥n', scripture: '"Convi√©rtanse y crean en el Evangelio."', ref: 'Marcos 1:15', feasts: [{ date: '2', name: 'Presentaci√≥n del Se√±or' }, { date: '18', name: 'Mi√©rcoles de Ceniza', solemnity: true }]},
      { name: 'Marzo', theme: 'Cuaresma', scripture: '"Ni√©guese a s√≠ mismo."', ref: 'Mateo 16:24', feasts: [{ date: '19', name: 'San Jos√©', solemnity: true }, { date: '25', name: 'Anunciaci√≥n', solemnity: true }, { date: '29', name: 'Ramos', solemnity: true }]},
      { name: 'Abril', theme: 'Pascua', scripture: '"¬°Ha resucitado!"', ref: 'Mateo 28:6', feasts: [{ date: '2', name: 'Jueves Santo', solemnity: true }, { date: '3', name: 'Viernes Santo', solemnity: true }, { date: '5', name: 'Pascua', solemnity: true }]},
      { name: 'Mayo', theme: 'Mes de Mar√≠a', scripture: '"H√°gase en m√≠ seg√∫n tu palabra."', ref: 'Lucas 1:38', feasts: [{ date: '13', name: 'F√°tima' }, { date: '14', name: 'Ascensi√≥n', solemnity: true }, { date: '24', name: 'Pentecost√©s', solemnity: true }]},
      { name: 'Junio', theme: 'Sagrado Coraz√≥n', scripture: '"Vengan a m√≠ todos los que est√°n cansados."', ref: 'Mateo 11:28', feasts: [{ date: '7', name: 'Corpus Christi', solemnity: true }, { date: '12', name: 'Sagrado Coraz√≥n', solemnity: true }]},
      { name: 'Julio', theme: 'Presencia de Dios', scripture: '"Permanezcan en m√≠."', ref: 'Juan 15:4', feasts: [{ date: '16', name: 'Virgen del Carmen' }, { date: '22', name: 'Mar√≠a Magdalena' }]},
      { name: 'Agosto', theme: 'Asunci√≥n', scripture: '"Engrandece mi alma al Se√±or."', ref: 'Lucas 1:46', feasts: [{ date: '6', name: 'Transfiguraci√≥n' }, { date: '15', name: 'Asunci√≥n', solemnity: true }]},
      { name: 'Septiembre', theme: 'Dolores de Mar√≠a', scripture: '"Junto a la cruz estaba su madre."', ref: 'Juan 19:25', feasts: [{ date: '8', name: 'Natividad de Mar√≠a' }, { date: '14', name: 'Exaltaci√≥n de la Cruz' }]},
      { name: 'Octubre', theme: 'Santo Rosario', scripture: '"Dios te salve, llena de gracia."', ref: 'Lucas 1:28', feasts: [{ date: '4', name: 'San Francisco' }, { date: '7', name: 'Virgen del Rosario' }]},
      { name: 'Noviembre', theme: 'Comuni√≥n de Santos', scripture: '"Bienaventurados los que lloran."', ref: 'Mateo 5:4', feasts: [{ date: '1', name: 'Todos los Santos', solemnity: true }, { date: '2', name: 'Fieles Difuntos' }, { date: '22', name: 'Cristo Rey', solemnity: true }]},
      { name: 'Diciembre', theme: 'Adviento y Navidad', scripture: '"El Verbo se hizo carne."', ref: 'Juan 1:14', feasts: [{ date: '8', name: 'Inmaculada', solemnity: true }, { date: '12', name: 'Guadalupe' }, { date: '25', name: 'Navidad', solemnity: true }]}
    ];
    
    var GOAL_CATEGORIES = [
      { id: 'spiritual', title: 'üïäÔ∏è Vida Espiritual', color: '#9B59B6' },
      { id: 'family', title: 'üíñ Familia y Relaciones', color: '#E85D4C' },
      { id: 'personal', title: 'üåø Personal y Emocional', color: '#2A9D8F' }
    ];
    
    var data = { lectios: [], intentions: [], monthlyGoals: {}, readChapters: [], currentMonth: new Date().getMonth() };
    var currentTab = 'lectio';
    var expandedCard = null;
    var selectedReadingType = 'random';
    var pendingReading = null;
    var currentPrayer = 'rosary_joyful';
    
    function init() {
      var saved = localStorage.getItem('spiritual-planner-v7');
      if (saved) { 
        data = JSON.parse(saved); 
        if (!data.readChapters) data.readChapters = []; 
        if (!data.monthlyGoals) data.monthlyGoals = {};
      }
      populateBookSelect();
      render();
    }
    
    function save() { localStorage.setItem('spiritual-planner-v7', JSON.stringify(data)); }
    
    function showStatus(msg, type) {
      var el = document.getElementById('statusMsg');
      el.textContent = msg; el.className = 'status-msg ' + type; el.style.display = 'block';
      if (type !== 'info') setTimeout(function() { el.style.display = 'none'; }, 3000);
    }
    
    function togglePrayer() {
      prayerExpanded = !prayerExpanded;
      var textEl = document.getElementById('prayerText');
      var btnEl = document.querySelector('.prayer-toggle');
      if (prayerExpanded) {
        textEl.innerHTML = '<p>' + fullPrayer.replace(/\n\n/g, '</p><p style="margin-top:12px;">').replace(/\n/g, '<br>') + '</p>';
        btnEl.textContent = 'Ver menos ‚ñ≤';
      } else {
        textEl.innerHTML = '<p>Madre Sant√≠sima, Se√±ora de mi coraz√≥n,<br>hoy me pongo bajo Tu manto de amor y protecci√≥n.<br>Te entrego mi d√≠a, con todo lo que trae:<br>mis alegr√≠as, mis desaf√≠os, mis miedos y mis esperanzas.</p>';
        btnEl.textContent = 'Ver oraci√≥n completa ‚ñº';
      }
    }
    
    function populateBookSelect() {
      var select = document.getElementById('bookSelect');
      var otBooks = BIBLE_BOOKS.filter(function(b) { return b.type === 'ot'; });
      var psalmBooks = BIBLE_BOOKS.filter(function(b) { return b.type === 'psalm'; });
      var gospelBooks = BIBLE_BOOKS.filter(function(b) { return b.type === 'gospel'; });
      var epistleBooks = BIBLE_BOOKS.filter(function(b) { return b.type === 'epistle'; });
      
      select.innerHTML = 
        '<optgroup label="üìï Pentateuco">' + otBooks.slice(0,5).map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('') + '</optgroup>' +
        '<optgroup label="üìó Hist√≥ricos">' + otBooks.slice(5,21).map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('') + '</optgroup>' +
        '<optgroup label="üìò Sapienciales">' + otBooks.slice(21,27).map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('') + psalmBooks.map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('') + '</optgroup>' +
        '<optgroup label="üìô Profetas">' + otBooks.slice(27).map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('') + '</optgroup>' +
        '<optgroup label="‚úùÔ∏è Evangelios">' + gospelBooks.map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('') + '</optgroup>' +
        '<optgroup label="‚úâÔ∏è Hechos y Cartas">' + epistleBooks.map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('') + '</optgroup>';
      updateChapters();
    }
    
    function updateChapters() {
      var bookAbbr = document.getElementById('bookSelect').value;
      var book = BIBLE_BOOKS.find(function(b) { return b.abbr === bookAbbr; });
      var select = document.getElementById('chapterSelect');
      var options = [];
      for (var ch = 1; ch <= book.chapters; ch++) {
        var isRead = data.readChapters.indexOf(bookAbbr + '-' + ch) !== -1;
        options.push('<option value="' + ch + '">' + ch + (isRead ? ' ‚úì' : '') + '</option>');
      }
      select.innerHTML = options.join('');
    }
    
    function getAllReadings(filter) {
      var readings = [];
      BIBLE_BOOKS.forEach(function(book) {
        if (filter && book.type !== filter) return;
        for (var ch = 1; ch <= book.chapters; ch++) {
          var key = book.abbr + '-' + ch;
          if (data.readChapters.indexOf(key) === -1) readings.push({ book: book, chapter: ch, key: key });
        }
      });
      return readings;
    }
    
    function getRandomUnreadChapter(filter) {
      var candidates = getAllReadings(filter);
      if (candidates.length === 0) {
        // Reset read chapters for this filter
        data.readChapters = data.readChapters.filter(function(k) {
          var abbr = k.split('-')[0];
          var book = BIBLE_BOOKS.find(function(b) { return b.abbr === abbr; });
          return book && filter && book.type !== filter;
        });
        save();
        candidates = getAllReadings(filter);
      }
      if (candidates.length === 0) return null;
      return candidates[Math.floor(Math.random() * candidates.length)];
    }
    
    function selectReadingType(type) {
      selectedReadingType = type;
      document.querySelectorAll('.reading-option').forEach(function(el) { el.classList.remove('selected'); });
      event.target.classList.add('selected');
      var manualSelect = document.getElementById('manualSelect');
      var selectedDiv = document.getElementById('selectedReading');
      if (type === 'manual') {
        manualSelect.style.display = 'block';
        selectedDiv.style.display = 'none';
        pendingReading = null;
      } else {
        manualSelect.style.display = 'none';
        var filter = type === 'random' ? null : type;
        var reading = getRandomUnreadChapter(filter);
        pendingReading = reading;
        if (reading) {
          selectedDiv.style.display = 'block';
          document.getElementById('selectedReadingText').textContent = reading.book.name + ' ' + reading.chapter;
        } else {
          selectedDiv.style.display = 'block';
          document.getElementById('selectedReadingText').textContent = '¬°Has le√≠do todo! Selecciona manualmente.';
        }
      }
    }
    
    function formatScripture(text) {
      if (!text) return '<p style="color:#6b7280;font-style:italic;">Lee este cap√≠tulo en tu Biblia f√≠sica o aplicaci√≥n de Biblia Cat√≥lica.</p>';
      return text.replace(/(\d+)\s/g, '<span class="verse-num">$1</span> ');
    }
    
    function startLectio() {
      var reading;
      if (selectedReadingType === 'manual') {
        var bookAbbr = document.getElementById('bookSelect').value;
        var chapter = parseInt(document.getElementById('chapterSelect').value);
        var book = BIBLE_BOOKS.find(function(b) { return b.abbr === bookAbbr; });
        reading = { book: book, chapter: chapter, key: bookAbbr + '-' + chapter };
      } else {
        reading = pendingReading;
      }
      if (!reading) { alert('Por favor selecciona una lectura'); return; }
      
      if (data.readChapters.indexOf(reading.key) === -1) data.readChapters.push(reading.key);
      
      var scriptureText = BIBLE_TEXT[reading.book.abbr + '-' + reading.chapter] || null;
      
      var today = new Date().toISOString().slice(0, 10);
      data.lectios.push({
        id: Date.now(),
        date: today,
        timestamp: new Date().toISOString(),
        bookAbbr: reading.book.abbr,
        bookName: reading.book.name,
        chapter: reading.chapter,
        reference: reading.book.name + ' ' + reading.chapter,
        scriptureText: scriptureText,
        lectio: '', meditatio: '', oratio: '', contemplatio: ''
      });
      
      save();
      closeModal('lectioModal');
      expandedCard = 'lectio-' + data.lectios[data.lectios.length - 1].id;
      render();
    }
    
    function getStreak() {
      var streak = 0;
      var today = new Date(); today.setHours(0,0,0,0);
      for (var i = 0; i < 365; i++) {
        var checkDate = new Date(today); checkDate.setDate(checkDate.getDate() - i);
        var dateStr = checkDate.toISOString().slice(0, 10);
        if (data.lectios.some(function(l) { return l.date === dateStr; })) streak++;
        else if (i > 0) break;
      }
      return streak;
    }
    
    function getTodayLectios() {
      var today = new Date().toISOString().slice(0, 10);
      return data.lectios.filter(function(l) { return l.date === today; });
    }
    
    function getTotalChapters() {
      return BIBLE_BOOKS.reduce(function(sum, b) { return sum + b.chapters; }, 0);
    }
    
    function renderDashboard() {
      var streak = getStreak();
      var totalChapters = getTotalChapters();
      var progress = Math.round((data.readChapters.length / totalChapters) * 100);
      var answered = data.intentions.filter(function(i) { return i.answered; }).length;
      document.getElementById('dashboard').innerHTML = 
        '<div class="stat"><div class="stat-num" style="color:#E85D4C;">‚ô• ' + streak + '</div><div class="stat-label">D√≠as Seguidos</div></div>' +
        '<div class="stat"><div class="stat-num" style="color:#F4C430;">' + getTodayLectios().length + '</div><div class="stat-label">Hoy</div></div>' +
        '<div class="stat"><div class="stat-num" style="color:#2A9D8F;">' + progress + '%</div><div class="stat-label">' + data.readChapters.length + '/' + totalChapters + '</div><div class="progress-bar"><div class="progress-fill" style="width:' + progress + '%;"></div></div></div>' +
        '<div class="stat"><div class="stat-num" style="color:#6B8EAE;">' + answered + '/' + data.intentions.length + '</div><div class="stat-label">Intenciones</div></div>';
    }
    
    function renderTabs() {
      var tabs = [
        { id: 'lectio', label: 'üìñ Lectio' },
        { id: 'prayers', label: 'üôè Oraciones' },
        { id: 'intentions', label: 'üíù Intenciones' },
        { id: 'month', label: 'üìÖ ' + MONTHS[data.currentMonth].name }
      ];
      document.getElementById('tabs').innerHTML = tabs.map(function(t) {
        return '<button class="tab ' + (currentTab === t.id ? 'active' : '') + '" onclick="setTab(\'' + t.id + '\')">' + t.label + '</button>';
      }).join('');
    }
    
    function setTab(tab) { currentTab = tab; expandedCard = null; render(); }
    
    function render() {
      renderDashboard();
      renderTabs();
      var content = document.getElementById('content');
      if (currentTab === 'lectio') content.innerHTML = renderLectioTab();
      else if (currentTab === 'prayers') content.innerHTML = renderPrayersTab();
      else if (currentTab === 'intentions') content.innerHTML = renderIntentionsTab();
      else if (currentTab === 'month') content.innerHTML = renderMonthTab();
    }
    
    function renderLectioTab() {
      var todayLectios = getTodayLectios();
      var html = '<div style="text-align:center;margin-bottom:16px;"><button class="btn btn-primary" onclick="openLectioModal()">üìñ Nueva Lectio Divina</button></div>';
      html += '<div class="scripture-box"><p class="scripture-quote">"Habla, Se√±or, que tu siervo escucha."</p><p class="scripture-ref">1 Samuel 3:10</p></div>';
      
      if (todayLectios.length > 0) {
        html += '<div class="today-lectios"><div class="today-lectios-title">üìÖ Lecturas de Hoy (' + todayLectios.length + ')</div>' +
          todayLectios.map(function(l) { return '<div class="today-lectio-item">‚Ä¢ ' + l.reference + '</div>'; }).join('') + '</div>';
      }
      
      var sorted = data.lectios.slice().sort(function(a, b) { return (b.timestamp || b.date).localeCompare(a.timestamp || a.date); });
      if (sorted.length === 0) {
        html += '<div class="empty-state">A√∫n no tienes entradas de Lectio Divina.<br>¬°Comienza tu encuentro diario con la Palabra de Dios!</div>';
      } else {
        html += sorted.map(function(l) {
          var isExp = expandedCard === 'lectio-' + l.id;
          var dateObj = new Date(l.date + 'T12:00:00');
          var dateStr = dateObj.toLocaleDateString('es-ES', { weekday: 'short', day: 'numeric', month: 'short' });
          var isToday = l.date === new Date().toISOString().slice(0, 10);
          
          return '<div class="card lectio-card ' + (isExp ? 'expanded' : '') + '">' +
            '<div class="card-header" onclick="toggleCard(\'lectio-' + l.id + '\')">' + chevronSVG +
              '<div style="flex:1;"><div class="lectio-date">' + dateStr + '</div><div class="lectio-reading">üìú ' + l.reference + '</div></div>' +
              (isToday ? '<span style="background:#FFF3CD;color:#856404;padding:4px 8px;border-radius:12px;font-size:11px;">Hoy</span>' : '') +
            '</div>' +
            '<div class="card-body">' +
              '<div class="scripture-display"><div class="scripture-reference">üìñ ' + l.reference + '</div><div class="scripture-text">' + formatScripture(l.scriptureText) + '</div></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üìñ 1. Lectio</div><textarea class="lectio-textarea" placeholder="¬øQu√© palabras te llaman la atenci√≥n?" onchange="updateLectio(' + l.id + ', \'lectio\', this.value)">' + escapeHtml(l.lectio || '') + '</textarea></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üí≠ 2. Meditatio</div><textarea class="lectio-textarea" placeholder="¬øQu√© me dice el Se√±or?" onchange="updateLectio(' + l.id + ', \'meditatio\', this.value)">' + escapeHtml(l.meditatio || '') + '</textarea></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üôè 3. Oratio</div><textarea class="lectio-textarea" placeholder="Tu respuesta en oraci√≥n..." onchange="updateLectio(' + l.id + ', \'oratio\', this.value)">' + escapeHtml(l.oratio || '') + '</textarea></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üå∏ 4. Contemplatio</div><textarea class="lectio-textarea" placeholder="Descansa en silencio..." onchange="updateLectio(' + l.id + ', \'contemplatio\', this.value)">' + escapeHtml(l.contemplatio || '') + '</textarea></div>' +
              '<div style="text-align:right;margin-top:12px;"><button class="btn btn-danger btn-small" onclick="deleteLectio(' + l.id + '); event.stopPropagation();">Eliminar</button></div>' +
            '</div></div>';
        }).join('');
      }
      return html;
    }
    
    function renderPrayersTab() {
      var html = '<div class="prayer-nav">' +
        Object.keys(PRAYERS).map(function(key) {
          var label = key === 'rosary_joyful' ? 'Gozosos' : key === 'rosary_sorrowful' ? 'Dolorosos' : key === 'rosary_glorious' ? 'Gloriosos' : key === 'rosary_luminous' ? 'Luminosos' : key === 'divine_mercy' ? 'Coronilla' : 'Anima';
          return '<button class="prayer-nav-btn ' + (currentPrayer === key ? 'active' : '') + '" onclick="setPrayer(\'' + key + '\')">' + label + '</button>';
        }).join('') + '</div>';
      var prayer = PRAYERS[currentPrayer];
      html += '<div class="card prayer-card expanded"><div class="card-body" style="display:block;"><div class="prayer-title">' + prayer.title + '</div><div class="prayer-subtitle">' + prayer.subtitle + '</div><div class="prayer-content" style="margin-top:16px;">' + prayer.content + '</div></div></div>';
      return html;
    }
    
    function setPrayer(key) { currentPrayer = key; render(); }
    
    function renderIntentionsTab() {
      var html = '<div style="text-align:center;margin-bottom:16px;"><button class="btn btn-primary" onclick="openModal(\'intentionModal\')">üíù Agregar Intenci√≥n</button></div>';
      var cats = [{ id: 'family', title: 'üë®‚Äçüë©‚Äçüëß Por mi familia' }, { id: 'spiritual', title: 'üïäÔ∏è Vida espiritual' }, { id: 'others', title: 'üôè Por otros' }, { id: 'thanksgiving', title: 'üíõ Acci√≥n de Gracias' }];
      cats.forEach(function(cat) {
        var items = data.intentions.filter(function(i) { return i.category === cat.id; });
        if (items.length > 0) {
          html += '<div class="intention-category"><div class="intention-category-title">' + cat.title + '</div><ul class="intention-list">' +
            items.map(function(i) {
              return '<li class="intention-item"><div class="intention-check ' + (i.answered ? 'done' : '') + '" onclick="toggleIntention(' + i.id + ')">' + (i.answered ? '‚úì' : '') + '</div><span class="intention-text" style="' + (i.answered ? 'text-decoration:line-through;color:#9ca3af;' : '') + '">' + escapeHtml(i.text) + '</span><button class="btn btn-danger btn-small" onclick="deleteIntention(' + i.id + '); event.stopPropagation();">√ó</button></li>';
            }).join('') + '</ul></div>';
        }
      });
      if (data.intentions.length === 0) html += '<div class="empty-state">"Pidan y se les dar√°" (Mt 7:7)</div>';
      return html;
    }
    
    function renderMonthTab() {
      var month = MONTHS[data.currentMonth];
      var monthKey = 'month-' + data.currentMonth;
      var goals = data.monthlyGoals[monthKey] || [];
      
      var html = '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">' +
        '<button class="btn btn-secondary btn-small" onclick="changeMonth(-1)">‚Üê</button>' +
        '<h2 style="font-size:18px;color:#E85D4C;">' + month.name + ' 2026</h2>' +
        '<button class="btn btn-secondary btn-small" onclick="changeMonth(1)">‚Üí</button></div>' +
        '<p style="text-align:center;font-style:italic;color:#5A5A5A;margin-bottom:16px;">' + month.theme + '</p>' +
        '<div class="scripture-box"><p class="scripture-quote">' + month.scripture + '</p><p class="scripture-ref">' + month.ref + '</p></div>';
      
      // MONTHLY GOALS BY CATEGORY
      html += '<div class="month-goals"><h3>‚ú® Metas de ' + month.name + '</h3>';
      html += '<div class="add-goal-row"><select class="add-goal-select" id="newGoalCategory">' +
        GOAL_CATEGORIES.map(function(c) { return '<option value="' + c.id + '">' + c.title + '</option>'; }).join('') +
        '</select><input type="text" class="add-goal-input" id="newGoalInput" placeholder="Nueva meta..." onkeypress="if(event.key===\'Enter\')addMonthlyGoal()"><button class="btn btn-primary btn-small" onclick="addMonthlyGoal()">+</button></div>';
      
      GOAL_CATEGORIES.forEach(function(cat) {
        var catGoals = goals.filter(function(g) { return g.category === cat.id; });
        html += '<div class="goal-category ' + cat.id + '"><div class="goal-category-title">' + cat.title + '</div>';
        if (catGoals.length > 0) {
          html += catGoals.map(function(g) {
            return '<div class="goal-item"><div class="goal-check ' + (g.done ? 'done' : '') + '" onclick="toggleMonthlyGoal(\'' + monthKey + '\', ' + g.id + ')">' + (g.done ? '‚úì' : '') + '</div><span class="goal-text ' + (g.done ? 'done' : '') + '">' + escapeHtml(g.text) + '</span><button class="btn btn-danger btn-small" onclick="deleteMonthlyGoal(\'' + monthKey + '\', ' + g.id + '); event.stopPropagation();">√ó</button></div>';
          }).join('');
        } else {
          html += '<p style="font-size:12px;color:#9ca3af;font-style:italic;">Sin metas a√∫n</p>';
        }
        html += '</div>';
      });
      html += '</div>';
      
      // FEAST DAYS
      html += '<div class="feast-days"><h3 style="font-size:14px;color:#E85D4C;margin-bottom:10px;">üìÖ Fiestas</h3>' +
        month.feasts.map(function(f) { return '<div class="feast-day"><span class="feast-date">' + f.date + '</span> ‚Äî ' + f.name + (f.solemnity ? '<span class="feast-solemnity">Solemnidad</span>' : '') + '</div>'; }).join('') + '</div>';
      
      // CALENDAR
      html += '<div style="background:white;border-radius:12px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,0.06);border:1px solid #f0f0f0;">' + renderCalendar(data.currentMonth) + '</div>';
      
      return html;
    }
    
    function renderCalendar(monthIndex) {
      var year = 2026, firstDay = new Date(year, monthIndex, 1), lastDay = new Date(year, monthIndex + 1, 0);
      var startDay = firstDay.getDay(), daysInMonth = lastDay.getDate();
      var today = new Date(), todayDate = today.getDate(), todayMonth = today.getMonth(), todayYear = today.getFullYear();
      var feastDays = MONTHS[monthIndex].feasts.map(function(f) { return parseInt(f.date) || 0; });
      var days = ['D','L','M','X','J','V','S'];
      var html = '<div class="calendar-grid">';
      days.forEach(function(d) { html += '<div class="calendar-header">' + d + '</div>'; });
      for (var i = 0; i < startDay; i++) html += '<div class="calendar-day empty"></div>';
      for (var d = 1; d <= daysInMonth; d++) {
        var dateStr = year + '-' + String(monthIndex + 1).padStart(2, '0') + '-' + String(d).padStart(2, '0');
        var hasEntry = data.lectios.some(function(l) { return l.date === dateStr; });
        var isToday = d === todayDate && monthIndex === todayMonth && year === todayYear;
        var isFeast = feastDays.indexOf(d) !== -1;
        var cls = 'calendar-day' + (isToday ? ' today' : hasEntry ? ' has-entry' : isFeast ? ' feast' : '');
        html += '<div class="' + cls + '">' + d + '</div>';
      }
      return html + '</div>';
    }
    
    function changeMonth(delta) { data.currentMonth = (data.currentMonth + delta + 12) % 12; save(); render(); }
    function toggleCard(cardId) { expandedCard = expandedCard === cardId ? null : cardId; render(); }
    function escapeHtml(str) { return str ? str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;') : ''; }
    function openModal(id) { document.getElementById(id).classList.add('open'); }
    function closeModal(id) { document.getElementById(id).classList.remove('open'); }
    
    function openLectioModal() {
      selectedReadingType = 'random';
      document.querySelectorAll('.reading-option').forEach(function(el, i) { el.classList.toggle('selected', i === 0); });
      document.getElementById('manualSelect').style.display = 'none';
      var reading = getRandomUnreadChapter(null);
      pendingReading = reading;
      if (reading) {
        document.getElementById('selectedReading').style.display = 'block';
        document.getElementById('selectedReadingText').textContent = reading.book.name + ' ' + reading.chapter;
      }
      openModal('lectioModal');
    }
    
    function updateLectio(id, field, value) { data.lectios = data.lectios.map(function(l) { if (l.id === id) l[field] = value; return l; }); save(); }
    function deleteLectio(id) { if (confirm('¬øEliminar esta entrada?')) { data.lectios = data.lectios.filter(function(l) { return l.id !== id; }); save(); render(); } }
    
    function saveIntention() {
      var cat = document.getElementById('intentionCategory').value;
      var text = document.getElementById('intentionText').value.trim();
      if (!text) { alert('Por favor escribe una intenci√≥n'); return; }
      data.intentions.push({ id: Date.now(), category: cat, text: text, answered: false });
      save(); closeModal('intentionModal'); document.getElementById('intentionText').value = ''; render();
    }
    
    function toggleIntention(id) { data.intentions = data.intentions.map(function(i) { if (i.id === id) i.answered = !i.answered; return i; }); save(); render(); }
    function deleteIntention(id) { data.intentions = data.intentions.filter(function(i) { return i.id !== id; }); save(); render(); }
    
    function addMonthlyGoal() {
      var input = document.getElementById('newGoalInput');
      var catSelect = document.getElementById('newGoalCategory');
      var text = input.value.trim();
      var category = catSelect.value;
      if (!text) return;
      var monthKey = 'month-' + data.currentMonth;
      if (!data.monthlyGoals[monthKey]) data.monthlyGoals[monthKey] = [];
      data.monthlyGoals[monthKey].push({ id: Date.now(), text: text, category: category, done: false });
      input.value = '';
      save();
      render();
    }
    
    function toggleMonthlyGoal(monthKey, id) {
      if (data.monthlyGoals[monthKey]) {
        data.monthlyGoals[monthKey] = data.monthlyGoals[monthKey].map(function(g) { if (g.id === id) g.done = !g.done; return g; });
        save(); render();
      }
    }
    
    function deleteMonthlyGoal(monthKey, id) {
      if (data.monthlyGoals[monthKey]) {
        data.monthlyGoals[monthKey] = data.monthlyGoals[monthKey].filter(function(g) { return g.id !== id; });
        save(); render();
      }
    }
    
    function exportData() {
      var blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      var a = document.createElement('a'); a.href = URL.createObjectURL(blob);
      a.download = 'planner-espiritual-' + new Date().toISOString().slice(0, 10) + '.json'; a.click();
      showStatus('Exportado', 'success');
    }
    
    function importData(event) {
      var file = event.target.files[0]; if (!file) return;
      var reader = new FileReader();
      reader.onload = function(e) {
        try { data = JSON.parse(e.target.result); if (!data.readChapters) data.readChapters = []; if (!data.monthlyGoals) data.monthlyGoals = {}; save(); render(); showStatus('Importado', 'success'); }
        catch (err) { showStatus('Error', 'error'); }
      };
      reader.readAsText(file);
    }
    
    init();
  </script>
</body>
</html>
