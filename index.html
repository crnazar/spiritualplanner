<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Planificador Espiritual 2026</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body { 
      font-family: 'Georgia', serif; 
      min-height: 100vh; 
      color: #1f2937;
      background-color: #FDF8F5;
    }
    
    .container { max-width: 900px; margin: 0 auto; padding: 20px; }
    
    h1 { font-size: 1.8rem; font-weight: 700; text-align: center; margin-bottom: 4px; color: #E85D4C; }
    .subtitle { color: #6B8EAE; text-align: center; margin-bottom: 8px; font-size: 14px; font-style: italic; }
    
    .today-header { background: linear-gradient(135deg, #FFF8E7 0%, #FEFAF5 100%); border-radius: 12px; padding: 16px; margin-bottom: 20px; text-align: center; border: 1px solid #F4C430; }
    .today-date { font-size: 18px; color: #E85D4C; font-weight: 600; }
    .today-feast { font-size: 14px; color: #5A5A5A; margin-top: 6px; font-style: italic; }
    
    .holy-images { display: flex; justify-content: center; gap: 16px; margin-bottom: 20px; flex-wrap: wrap; }
    .holy-icon { text-align: center; background: linear-gradient(135deg, #FFF8E7 0%, #FEFAF5 100%); border-radius: 50%; width: 70px; height: 70px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 3px solid #F4C430; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .icon-emoji { font-size: 28px; line-height: 1; }
    .holy-label { font-size: 8px; color: #6b7280; margin-top: 2px; }
    
    .status-msg { text-align: center; padding: 10px; margin-bottom: 16px; border-radius: 8px; font-size: 14px; }
    .status-msg.success { background: #D4EDDA; color: #155724; }
    .status-msg.error { background: #F8D7DA; color: #721C24; }
    
    .music-player { background: linear-gradient(135deg, #2D2D2D 0%, #1a1a1a 100%); border-radius: 12px; padding: 12px 16px; margin-bottom: 20px; }
    .music-player-title { color: #F4C430; font-size: 13px; font-weight: 600; }
    .music-select { background: #3D3D3D; border: none; color: white; padding: 8px; border-radius: 6px; font-size: 12px; width: 100%; margin: 8px 0; }
    
    .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px; margin-bottom: 24px; }
    .stat { background: white; border-radius: 12px; padding: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06); border: 1px solid #f0f0f0; }
    .stat-num { font-size: 24px; font-weight: 700; }
    .stat-label { font-size: 10px; color: #6b7280; margin-top: 4px; text-transform: uppercase; }
    .progress-bar { height: 4px; background: #e5e7eb; border-radius: 2px; margin-top: 6px; overflow: hidden; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #9DD3C9, #6B8EAE); border-radius: 2px; }
    
    .tabs { display: flex; gap: 4px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
    .tab { padding: 10px 12px; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 12px; background: #f0f0f0; color: #5A5A5A; transition: all 0.2s; }
    .tab:hover { background: #e0e0e0; }
    .tab.active { background: #9DD3C9; color: #1f2937; }
    
    .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; transition: all 0.2s; }
    .btn-primary { background: #9DD3C9; color: #1f2937; }
    .btn-primary:hover { background: #7CC4B8; }
    .btn-secondary { background: #6B8EAE; color: white; }
    .btn-secondary:hover { background: #5A7D9D; }
    .btn-small { padding: 6px 12px; font-size: 12px; }
    .btn-danger { background: #dc3545; color: white; }
    .btn-danger:hover { background: #c82333; }
    
    .card { background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); border-left: 4px solid; overflow: hidden; margin-bottom: 12px; }
    .card-header { padding: 16px; cursor: pointer; display: flex; align-items: center; gap: 12px; }
    .card-header:hover { background: #FEFAF5; }
    .chevron { width: 20px; height: 20px; color: #9ca3af; transition: transform 0.2s; flex-shrink: 0; }
    .card.expanded .chevron { transform: rotate(90deg); }
    .card-body { display: none; border-top: 1px solid #f0f0f0; padding: 16px; }
    .card.expanded .card-body { display: block; }
    
    .lectio-card { border-color: #9DD3C9; }
    .lectio-date { font-size: 14px; color: #2A9D8F; font-weight: 600; }
    .lectio-reading { font-size: 13px; color: #6b7280; margin-top: 4px; }
    .lectio-section { margin-bottom: 16px; }
    .lectio-section-title { font-size: 13px; font-weight: 600; color: #2A9D8F; margin-bottom: 6px; }
    .lectio-textarea { width: 100%; min-height: 80px; padding: 10px; border-radius: 8px; border: 1px solid #e0e0e0; font-size: 14px; font-family: 'Georgia', serif; resize: vertical; line-height: 1.6; }
    .lectio-textarea:focus { outline: none; border-color: #9DD3C9; }
    
    .scripture-display { background: linear-gradient(135deg, #FFF8E7 0%, #FEFAF5 100%); border-radius: 12px; padding: 20px; margin-bottom: 16px; border: 1px solid #F4C430; text-align: center; }
    .scripture-reference { font-size: 18px; color: #E85D4C; font-weight: 600; margin-bottom: 12px; }
    .scripture-link { display: inline-block; background: #E85D4C; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-size: 14px; margin: 5px; }
    .scripture-link:hover { background: #D64D3C; }
    
    .reading-options { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
    .reading-option { padding: 8px 16px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; font-size: 13px; background: white; transition: all 0.2s; }
    .reading-option:hover { border-color: #9DD3C9; }
    .reading-option.selected { border-color: #2A9D8F; background: #E8F6F3; }
    
    .prayer-card { border-color: #F4C430; }
    .prayer-title { font-size: 16px; font-weight: 600; color: #E85D4C; }
    .prayer-subtitle { font-size: 12px; color: #6b7280; margin-top: 2px; }
    .prayer-content { font-size: 14px; line-height: 1.9; color: #1f2937; }
    .prayer-content p { margin-bottom: 12px; }
    .prayer-content .response { color: #2A9D8F; font-weight: 500; }
    .prayer-content h4 { color: #E85D4C; font-size: 14px; margin: 16px 0 8px 0; }
    .prayer-content .mystery { background: #FFF8E7; padding: 12px; border-radius: 8px; margin-bottom: 10px; border-left: 3px solid #F4C430; }
    .prayer-content .mystery-title { font-weight: 600; color: #E85D4C; }
    .prayer-content .mystery-meditation { font-size: 13px; color: #5A5A5A; margin-top: 6px; font-style: italic; }
    .prayer-content .mystery-fruit { font-size: 12px; color: #6b7280; margin-top: 4px; }
    
    .intention-item { display: flex; align-items: flex-start; gap: 8px; padding: 8px 0; border-bottom: 1px dashed #e0e0e0; }
    .intention-item:last-child { border-bottom: none; }
    .intention-check { width: 18px; height: 18px; border-radius: 50%; border: 2px solid #9DD3C9; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .intention-check.done { background: #9DD3C9; color: white; font-size: 10px; }
    
    .goal-category { padding: 14px; background: #FEFAF5; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #9DD3C9; }
    .goal-category-title { font-size: 13px; font-weight: 600; margin-bottom: 8px; color: #2A9D8F; }
    .goal-item { display: flex; align-items: flex-start; gap: 10px; padding: 8px 0; border-bottom: 1px solid #f0f0f0; }
    .goal-item:last-child { border-bottom: none; }
    .goal-check { width: 18px; height: 18px; border-radius: 4px; border: 2px solid #9DD3C9; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .goal-check.done { background: #9DD3C9; color: white; }
    .goal-text { flex: 1; font-size: 13px; }
    .goal-text.done { text-decoration: line-through; color: #9ca3af; }
    
    .scripture-box { background: linear-gradient(135deg, #FFF8E7 0%, #FEFAF5 100%); border-radius: 8px; padding: 14px; margin-bottom: 12px; text-align: center; border: 1px solid #F4C430; }
    .scripture-quote { font-size: 15px; font-style: italic; color: #5A5A5A; line-height: 1.6; }
    .scripture-ref { font-size: 12px; color: #E85D4C; margin-top: 6px; }
    
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-top: 12px; }
    .calendar-header { text-align: center; font-size: 11px; font-weight: 600; color: #6b7280; padding: 6px; }
    .calendar-day { text-align: center; padding: 8px 4px; border-radius: 6px; font-size: 12px; cursor: pointer; background: white; border: 1px solid #f0f0f0; }
    .calendar-day:hover { background: #FFF8E7; }
    .calendar-day.today { background: #E85D4C; color: white; border-color: #E85D4C; }
    .calendar-day.feast { background: #FFF3CD; border-color: #F4C430; }
    .calendar-day.empty { background: transparent; border-color: transparent; cursor: default; }
    
    .form-group { margin-bottom: 14px; }
    .form-label { font-size: 12px; color: #6b7280; margin-bottom: 4px; display: block; }
    .form-select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #e0e0e0; font-size: 14px; background: white; }
    
    .empty-state { text-align: center; padding: 40px; color: #9ca3af; }
    
    .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.4); display: none; align-items: center; justify-content: center; z-index: 100; padding: 20px; }
    .modal.open { display: flex; }
    .modal-box { background: white; border-radius: 16px; padding: 24px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
    .modal-title { font-size: 18px; font-weight: 600; margin-bottom: 20px; color: #1f2937; }
    .modal-close { float: right; background: none; border: none; font-size: 24px; cursor: pointer; color: #9ca3af; }
    
    .export-row { display: flex; gap: 8px; justify-content: center; margin-top: 24px; flex-wrap: wrap; }
    
    .prayer-nav { display: flex; gap: 4px; flex-wrap: wrap; margin-bottom: 16px; justify-content: center; }
    .prayer-nav-btn { padding: 5px 10px; border: 2px solid #F4C430; border-radius: 16px; background: white; cursor: pointer; font-size: 10px; color: #5A5A5A; transition: all 0.2s; }
    .prayer-nav-btn:hover { background: #FFF8E7; }
    .prayer-nav-btn.active { background: #F4C430; color: #1f2937; }
    
    .month-goals { background: white; border-radius: 12px; padding: 16px; margin-bottom: 16px; border: 1px solid #f0f0f0; }
    .month-goals h3 { font-size: 15px; color: #E85D4C; margin-bottom: 16px; }
    .add-goal-row { display: flex; gap: 8px; margin-bottom: 12px; }
    .add-goal-input { flex: 1; padding: 8px 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 13px; }
    .add-goal-select { padding: 8px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 12px; }
    
    .litany-section { margin-bottom: 16px; }
    .litany-section h4 { color: #E85D4C; font-size: 13px; margin-bottom: 8px; border-bottom: 1px solid #F4C430; padding-bottom: 4px; }
    .litany-line { display: flex; justify-content: space-between; padding: 4px 0; font-size: 13px; }
    .litany-call { color: #1f2937; }
    .litany-response { color: #2A9D8F; font-weight: 500; font-style: italic; }
    
    .bible-progress { background: white; border-radius: 12px; padding: 16px; margin-bottom: 16px; border: 1px solid #f0f0f0; }
    .bible-progress h3 { font-size: 15px; color: #E85D4C; margin-bottom: 12px; }
    .book-progress-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 6px; }
    .book-progress-item { background: #FEFAF5; border-radius: 6px; padding: 6px; font-size: 10px; }
    .book-progress-name { font-weight: 600; color: #5A5A5A; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .book-progress-bar { height: 4px; background: #e5e7eb; border-radius: 2px; margin-top: 4px; overflow: hidden; }
    .book-progress-fill { height: 100%; background: linear-gradient(90deg, #9DD3C9, #6B8EAE); border-radius: 2px; }
    
    .rosary-container { background: linear-gradient(135deg, #2D2D2D 0%, #1a1a1a 100%); border-radius: 16px; padding: 20px; margin-bottom: 16px; }
    .rosary-title { color: #F4C430; text-align: center; font-size: 16px; margin-bottom: 16px; }
    .rosary-beads { display: flex; justify-content: center; align-items: center; gap: 6px; flex-wrap: wrap; margin-bottom: 12px; }
    .rosary-bead { width: 24px; height: 24px; border-radius: 50%; border: 2px solid #6B8EAE; background: transparent; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #6B8EAE; font-size: 9px; transition: all 0.2s; }
    .rosary-bead.done { background: #9DD3C9; border-color: #9DD3C9; color: white; }
    .rosary-bead.large { width: 30px; height: 30px; border-color: #F4C430; color: #F4C430; }
    .rosary-bead.large.done { background: #F4C430; color: #1a1a1a; }
    
    .daily-prayers-tracker { background: white; border-radius: 12px; padding: 16px; margin-bottom: 16px; border: 1px solid #f0f0f0; }
    .daily-prayers-title { font-size: 16px; color: #E85D4C; margin-bottom: 4px; font-weight: 600; }
    .daily-prayers-date { font-size: 14px; color: #5A5A5A; margin-bottom: 12px; }
    .daily-prayer-item { display: flex; align-items: center; gap: 10px; padding: 8px 0; border-bottom: 1px solid #f0f0f0; }
    .daily-prayer-item:last-child { border-bottom: none; }
    .daily-prayer-check { width: 24px; height: 24px; border-radius: 50%; border: 2px solid #e0e0e0; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 12px; }
    .daily-prayer-check.done { border-color: #9DD3C9; background: #9DD3C9; color: white; }
    .daily-prayer-label { flex: 1; font-size: 13px; }
    
    .journal-entry { background: #FEFAF5; border-radius: 12px; padding: 16px; margin-bottom: 12px; border: 1px solid #F4C430; }
    .journal-date { font-size: 14px; color: #E85D4C; font-weight: 600; margin-bottom: 12px; }
    .journal-section { margin-bottom: 12px; }
    .journal-section-title { font-size: 12px; color: #6b7280; margin-bottom: 4px; }
    
    .prayer-history-item { background: #FEFAF5; border-radius: 8px; padding: 12px; margin-bottom: 8px; }
    .prayer-history-date { font-size: 14px; color: #E85D4C; font-weight: 600; }
    .prayer-history-prayers { font-size: 12px; color: #5A5A5A; margin-top: 6px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚úùÔ∏è Mi Planificador Espiritual</h1>
    <p class="subtitle"> 2026</p>
    
    <!-- TODAY'S DATE AND FEAST -->
    <div class="today-header">
      <div class="today-date" id="todayDate"></div>
      <div class="today-feast" id="todayFeast"></div>
    </div>
    
    <!-- HOLY IMAGES - Using emoji symbols that always work -->
    <div class="holy-images">
      <div class="holy-icon" title="Nuestra Se√±ora de Guadalupe">
        <span class="icon-emoji">üôè</span>
        <span class="holy-label">Mar√≠a</span>
      </div>
      <div class="holy-icon" title="La Sagrada Familia">
        <span class="icon-emoji">üë®‚Äçüë©‚Äçüë¶</span>
        <span class="holy-label">Sagrada Familia</span>
      </div>
      <div class="holy-icon" title="Jes√∫s de la Divina Misericordia">
        <span class="icon-emoji">‚úùÔ∏è</span>
        <span class="holy-label">Jes√∫s</span>
      </div>
      <div class="holy-icon" title="Sant√≠simo Sacramento">
        <span class="icon-emoji">üïäÔ∏è</span>
        <span class="holy-label">Esp√≠ritu Santo</span>
      </div>
      <div class="holy-icon" title="Coraz√≥n de Jes√∫s">
        <span class="icon-emoji">‚ù§Ô∏è‚Äçüî•</span>
        <span class="holy-label">Sagrado Coraz√≥n</span>
      </div>
    </div>
    
    <!-- MUSIC PLAYER -->
    <div class="music-player">
      <span class="music-player-title">üéµ Canto Gregoriano</span>
      <select class="music-select" id="chantSelect" onchange="changeChant()">
        <option value="trackistador/sets/gregorian-chants-free-to-use">Cantos Gregorianos (Varios)</option>
        <option value="themonksofglenstalabbey/sets/gregorian-chants-8">Monjes de Glenstal Abbey</option>
        <option value="logical-drift/sets/the-monks-of-notre-dame">Monjes de Notre Dame</option>
        <option value="thebenedictinemonksofstjames/sets/gregorian-chants-1">Monjes Benedictinos de St James</option>
        <option value="narmprlmotare/sets/gregorian-chant">Canto Gregoriano (Candelario)</option>
      </select>
      <iframe id="scPlayer" width="100%" height="120" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/trackistador/sets/gregorian-chants-free-to-use&color=%23e85d4c&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false"></iframe>
    </div>
    
    <div id="statusMsg" class="status-msg" style="display:none;"></div>
    
    <div class="dashboard" id="dashboard"></div>
    <div class="tabs" id="tabs"></div>
    <div id="content"></div>
    
    <div class="export-row">
      <button class="btn btn-secondary btn-small" onclick="exportData()">üíæ Exportar</button>
      <button class="btn btn-secondary btn-small" onclick="document.getElementById('importFile').click()">üìÇ Importar</button>
      <input type="file" id="importFile" accept=".json" onchange="importData(event)" style="display:none;">
    </div>
    
    <div style="margin-top:20px;padding:16px;background:#FFF8E7;border-radius:12px;border:1px solid #F4C430;">
      <h3 style="font-size:14px;color:#E85D4C;margin-bottom:8px;">üí° ¬øC√≥mo guardar tu progreso?</h3>
      <p style="font-size:12px;color:#5A5A5A;line-height:1.6;">Tu progreso se guarda autom√°ticamente en este navegador. Para no perderlo:<br>
      1. <strong>Exporta regularmente</strong> usando el bot√≥n "Exportar" (guarda un archivo .json)<br>
      2. <strong>Usa siempre el mismo navegador</strong> en este dispositivo<br>
      3. <strong>Importa tu archivo</strong> si cambias de dispositivo o navegador<br>
      4. <strong>No borres los datos del navegador</strong> (cookies/cach√©)</p>
    </div>
  </div>
  
  <!-- MODALS -->
  <div class="modal" id="lectioModal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('lectioModal')">√ó</button>
      <h3 class="modal-title">üìñ Nueva Lectio Divina</h3>
      <div class="form-group">
        <label class="form-label">Selecci√≥n de Lectura</label>
        <div class="reading-options">
          <div class="reading-option selected" onclick="selectReadingType('random')">üé≤ Al Azar</div>
          <div class="reading-option" onclick="selectReadingType('gospel')">üìú Evangelio</div>
          <div class="reading-option" onclick="selectReadingType('psalm')">üéµ Salmo</div>
          <div class="reading-option" onclick="selectReadingType('epistle')">‚úâÔ∏è Ep√≠stola</div>
          <div class="reading-option" onclick="selectReadingType('ot')">üìï AT</div>
          <div class="reading-option" onclick="selectReadingType('manual')">‚úèÔ∏è Elegir</div>
        </div>
      </div>
      <div id="manualSelect" style="display:none;">
        <div class="form-group">
          <label class="form-label">Libro</label>
          <select class="form-select" id="bookSelect" onchange="updateChapters()"></select>
        </div>
        <div class="form-group">
          <label class="form-label">Cap√≠tulo</label>
          <select class="form-select" id="chapterSelect"></select>
        </div>
      </div>
      <div id="selectedReading" style="margin:16px 0;padding:12px;background:#FFF8E7;border-radius:8px;display:none;">
        <span style="font-size:13px;color:#E85D4C;font-weight:600;">Seleccionado: </span>
        <span id="selectedReadingText" style="font-size:13px;color:#5A5A5A;"></span>
      </div>
      <button class="btn btn-primary" style="width:100%;" onclick="startLectio()">Comenzar Lectio Divina</button>
    </div>
  </div>
  
  <div class="modal" id="intentionModal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('intentionModal')">√ó</button>
      <h3 class="modal-title">üíù Nueva Intenci√≥n</h3>
      <div class="form-group">
        <label class="form-label">Categor√≠a</label>
        <select class="form-select" id="intentionCategory">
          <option value="family">Por mi familia y mi hogar</option>
          <option value="spiritual">Por mi vida espiritual</option>
          <option value="others">Por otros</option>
          <option value="thanksgiving">Acci√≥n de Gracias</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Intenci√≥n</label>
        <textarea class="lectio-textarea" id="intentionText" placeholder="Escribe tu intenci√≥n..." rows="3"></textarea>
      </div>
      <button class="btn btn-primary" style="width:100%;" onclick="saveIntention()">Agregar Intenci√≥n</button>
    </div>
  </div>
  
  <div class="modal" id="journalModal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('journalModal')">√ó</button>
      <h3 class="modal-title">üìù Diario Espiritual</h3>
      <div class="form-group">
        <label class="form-label">¬øC√≥mo me siento hoy?</label>
        <textarea class="lectio-textarea" id="journalFeeling" placeholder="Describe c√≥mo te sientes..." rows="3"></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">¬øQu√© aprend√≠ hoy?</label>
        <textarea class="lectio-textarea" id="journalLearned" placeholder="¬øQu√© aprendiste de Dios o de ti misma?" rows="3"></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">¬øQu√© quiero llevar conmigo en mi fe?</label>
        <textarea class="lectio-textarea" id="journalTakeaway" placeholder="Reflexi√≥n para tu camino..." rows="3"></textarea>
      </div>
      <button class="btn btn-primary" style="width:100%;" onclick="saveJournalEntry()">Guardar Entrada</button>
    </div>
  </div>

  <script>
    var chevronSVG = '<svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>';

    // SOUNDCLOUD
    function changeChant() {
      var path = document.getElementById('chantSelect').value;
      document.getElementById('scPlayer').src = 'https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/' + path + '&color=%23e85d4c&auto_play=true&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false';
    }

    // 73-BOOK CATHOLIC BIBLE WITH SPANISH USCCB LINKS
    var BIBLE_BOOKS = [
      { abbr: 'genesis', name: 'G√©nesis', usccb: 'genesis', chapters: 50, type: 'ot' },
      { abbr: 'exodo', name: '√âxodo', usccb: 'exodus', chapters: 40, type: 'ot' },
      { abbr: 'levitico', name: 'Lev√≠tico', usccb: 'leviticus', chapters: 27, type: 'ot' },
      { abbr: 'numeros', name: 'N√∫meros', usccb: 'numbers', chapters: 36, type: 'ot' },
      { abbr: 'deuteronomio', name: 'Deuteronomio', usccb: 'deuteronomy', chapters: 34, type: 'ot' },
      { abbr: 'josue', name: 'Josu√©', usccb: 'joshua', chapters: 24, type: 'ot' },
      { abbr: 'jueces', name: 'Jueces', usccb: 'judges', chapters: 21, type: 'ot' },
      { abbr: 'rut', name: 'Rut', usccb: 'ruth', chapters: 4, type: 'ot' },
      { abbr: '1samuel', name: '1 Samuel', usccb: '1samuel', chapters: 31, type: 'ot' },
      { abbr: '2samuel', name: '2 Samuel', usccb: '2samuel', chapters: 24, type: 'ot' },
      { abbr: '1reyes', name: '1 Reyes', usccb: '1kings', chapters: 22, type: 'ot' },
      { abbr: '2reyes', name: '2 Reyes', usccb: '2kings', chapters: 25, type: 'ot' },
      { abbr: '1cronicas', name: '1 Cr√≥nicas', usccb: '1chronicles', chapters: 29, type: 'ot' },
      { abbr: '2cronicas', name: '2 Cr√≥nicas', usccb: '2chronicles', chapters: 36, type: 'ot' },
      { abbr: 'esdras', name: 'Esdras', usccb: 'ezra', chapters: 10, type: 'ot' },
      { abbr: 'nehemias', name: 'Nehem√≠as', usccb: 'nehemiah', chapters: 13, type: 'ot' },
      { abbr: 'tobias', name: 'Tob√≠as', usccb: 'tobit', chapters: 14, type: 'ot' },
      { abbr: 'judit', name: 'Judit', usccb: 'judith', chapters: 16, type: 'ot' },
      { abbr: 'ester', name: 'Ester', usccb: 'esther', chapters: 16, type: 'ot' },
      { abbr: '1macabeos', name: '1 Macabeos', usccb: '1maccabees', chapters: 16, type: 'ot' },
      { abbr: '2macabeos', name: '2 Macabeos', usccb: '2maccabees', chapters: 15, type: 'ot' },
      { abbr: 'job', name: 'Job', usccb: 'job', chapters: 42, type: 'ot' },
      { abbr: 'salmos', name: 'Salmos', usccb: 'psalms', chapters: 150, type: 'psalm' },
      { abbr: 'proverbios', name: 'Proverbios', usccb: 'proverbs', chapters: 31, type: 'ot' },
      { abbr: 'eclesiastes', name: 'Eclesiast√©s', usccb: 'ecclesiastes', chapters: 12, type: 'ot' },
      { abbr: 'cantar', name: 'Cantar', usccb: 'songofsongs', chapters: 8, type: 'ot' },
      { abbr: 'sabiduria', name: 'Sabidur√≠a', usccb: 'wisdom', chapters: 19, type: 'ot' },
      { abbr: 'eclesiastico', name: 'Sir√°cida', usccb: 'sirach', chapters: 51, type: 'ot' },
      { abbr: 'isaias', name: 'Isa√≠as', usccb: 'isaiah', chapters: 66, type: 'ot' },
      { abbr: 'jeremias', name: 'Jerem√≠as', usccb: 'jeremiah', chapters: 52, type: 'ot' },
      { abbr: 'lamentaciones', name: 'Lament.', usccb: 'lamentations', chapters: 5, type: 'ot' },
      { abbr: 'baruc', name: 'Baruc', usccb: 'baruch', chapters: 6, type: 'ot' },
      { abbr: 'ezequiel', name: 'Ezequiel', usccb: 'ezekiel', chapters: 48, type: 'ot' },
      { abbr: 'daniel', name: 'Daniel', usccb: 'daniel', chapters: 14, type: 'ot' },
      { abbr: 'oseas', name: 'Oseas', usccb: 'hosea', chapters: 14, type: 'ot' },
      { abbr: 'joel', name: 'Joel', usccb: 'joel', chapters: 4, type: 'ot' },
      { abbr: 'amos', name: 'Am√≥s', usccb: 'amos', chapters: 9, type: 'ot' },
      { abbr: 'abdias', name: 'Abd√≠as', usccb: 'obadiah', chapters: 1, type: 'ot' },
      { abbr: 'jonas', name: 'Jon√°s', usccb: 'jonah', chapters: 4, type: 'ot' },
      { abbr: 'miqueas', name: 'Miqueas', usccb: 'micah', chapters: 7, type: 'ot' },
      { abbr: 'nahum', name: 'Nah√∫m', usccb: 'nahum', chapters: 3, type: 'ot' },
      { abbr: 'habacuc', name: 'Habacuc', usccb: 'habakkuk', chapters: 3, type: 'ot' },
      { abbr: 'sofonias', name: 'Sofon√≠as', usccb: 'zephaniah', chapters: 3, type: 'ot' },
      { abbr: 'ageo', name: 'Ageo', usccb: 'haggai', chapters: 2, type: 'ot' },
      { abbr: 'zacarias', name: 'Zacar√≠as', usccb: 'zechariah', chapters: 14, type: 'ot' },
      { abbr: 'malaquias', name: 'Malaqu√≠as', usccb: 'malachi', chapters: 3, type: 'ot' },
      { abbr: 'mateo', name: 'Mateo', usccb: 'matthew', chapters: 28, type: 'gospel' },
      { abbr: 'marcos', name: 'Marcos', usccb: 'mark', chapters: 16, type: 'gospel' },
      { abbr: 'lucas', name: 'Lucas', usccb: 'luke', chapters: 24, type: 'gospel' },
      { abbr: 'juan', name: 'Juan', usccb: 'john', chapters: 21, type: 'gospel' },
      { abbr: 'hechos', name: 'Hechos', usccb: 'acts', chapters: 28, type: 'epistle' },
      { abbr: 'romanos', name: 'Romanos', usccb: 'romans', chapters: 16, type: 'epistle' },
      { abbr: '1corintios', name: '1 Corintios', usccb: '1corinthians', chapters: 16, type: 'epistle' },
      { abbr: '2corintios', name: '2 Corintios', usccb: '2corinthians', chapters: 13, type: 'epistle' },
      { abbr: 'galatas', name: 'G√°latas', usccb: 'galatians', chapters: 6, type: 'epistle' },
      { abbr: 'efesios', name: 'Efesios', usccb: 'ephesians', chapters: 6, type: 'epistle' },
      { abbr: 'filipenses', name: 'Filipenses', usccb: 'philippians', chapters: 4, type: 'epistle' },
      { abbr: 'colosenses', name: 'Colosenses', usccb: 'colossians', chapters: 4, type: 'epistle' },
      { abbr: '1tesalonicenses', name: '1 Tesal.', usccb: '1thessalonians', chapters: 5, type: 'epistle' },
      { abbr: '2tesalonicenses', name: '2 Tesal.', usccb: '2thessalonians', chapters: 3, type: 'epistle' },
      { abbr: '1timoteo', name: '1 Timoteo', usccb: '1timothy', chapters: 6, type: 'epistle' },
      { abbr: '2timoteo', name: '2 Timoteo', usccb: '2timothy', chapters: 4, type: 'epistle' },
      { abbr: 'tito', name: 'Tito', usccb: 'titus', chapters: 3, type: 'epistle' },
      { abbr: 'filemon', name: 'Filem√≥n', usccb: 'philemon', chapters: 1, type: 'epistle' },
      { abbr: 'hebreos', name: 'Hebreos', usccb: 'hebrews', chapters: 13, type: 'epistle' },
      { abbr: 'santiago', name: 'Santiago', usccb: 'james', chapters: 5, type: 'epistle' },
      { abbr: '1pedro', name: '1 Pedro', usccb: '1peter', chapters: 5, type: 'epistle' },
      { abbr: '2pedro', name: '2 Pedro', usccb: '2peter', chapters: 3, type: 'epistle' },
      { abbr: '1juan', name: '1 Juan', usccb: '1john', chapters: 5, type: 'epistle' },
      { abbr: '2juan', name: '2 Juan', usccb: '2john', chapters: 1, type: 'epistle' },
      { abbr: '3juan', name: '3 Juan', usccb: '3john', chapters: 1, type: 'epistle' },
      { abbr: 'judas', name: 'Judas', usccb: 'jude', chapters: 1, type: 'epistle' },
      { abbr: 'apocalipsis', name: 'Apocalipsis', usccb: 'revelation', chapters: 22, type: 'epistle' }
    ];

    // ROSARY MYSTERIES WITH MEDITATIONS
    var ROSARY_MYSTERIES = {
      joyful: { 
        name: 'Misterios Gozosos', day: 'Lunes y S√°bado',
        mysteries: [
          { title: '1¬∫ La Anunciaci√≥n', text: 'El √°ngel Gabriel anuncia a Mar√≠a que ser√° la madre del Salvador. Mar√≠a, con humildad perfecta, acepta la voluntad de Dios.', fruit: 'Humildad' },
          { title: '2¬∫ La Visitaci√≥n', text: 'Mar√≠a visita a su prima Isabel llevando a Jes√∫s en su vientre. El encuentro est√° lleno de gozo y el Esp√≠ritu Santo.', fruit: 'Amor al Pr√≥jimo' },
          { title: '3¬∫ El Nacimiento de Jes√∫s', text: 'En la pobreza de un pesebre, nace el Rey del universo. Dios se hace peque√±o por amor a nosotros.', fruit: 'Desprendimiento' },
          { title: '4¬∫ La Presentaci√≥n en el Templo', text: 'Mar√≠a y Jos√© presentan a Jes√∫s en el Templo, cumpliendo la ley. Sime√≥n profetiza el dolor que traspasar√° el coraz√≥n de Mar√≠a.', fruit: 'Obediencia' },
          { title: '5¬∫ El Ni√±o Perdido y Hallado', text: 'Jes√∫s, a los doce a√±os, es encontrado en el Templo ense√±ando. Nos recuerda que debemos estar en las cosas del Padre.', fruit: 'Gozo de Encontrar a Jes√∫s' }
        ]
      },
      sorrowful: {
        name: 'Misterios Dolorosos', day: 'Martes y Viernes',
        mysteries: [
          { title: '1¬∫ La Oraci√≥n en el Huerto', text: 'Jes√∫s ora en Getseman√≠, sudando sangre por la angustia. Acepta la voluntad del Padre aunque le cueste la vida.', fruit: 'Dolor por los Pecados' },
          { title: '2¬∫ La Flagelaci√≥n', text: 'Jes√∫s es azotado cruelmente. Cada golpe es por nuestros pecados; su sangre nos purifica.', fruit: 'Mortificaci√≥n' },
          { title: '3¬∫ La Coronaci√≥n de Espinas', text: 'Los soldados se burlan de Jes√∫s, coron√°ndolo con espinas. El Rey de reyes es humillado por amor.', fruit: 'Desprecio del Mundo' },
          { title: '4¬∫ Jes√∫s Carga la Cruz', text: 'Jes√∫s carga el peso de la cruz y de nuestros pecados. Cada paso es un acto de amor infinito.', fruit: 'Paciencia' },
          { title: '5¬∫ La Crucifixi√≥n', text: 'Jes√∫s muere en la cruz, entregando su vida por la salvaci√≥n del mundo. "Todo est√° cumplido."', fruit: 'Conversi√≥n' }
        ]
      },
      glorious: {
        name: 'Misterios Gloriosos', day: 'Mi√©rcoles y Domingo',
        mysteries: [
          { title: '1¬∫ La Resurrecci√≥n', text: 'Jes√∫s resucita al tercer d√≠a, venciendo la muerte. La tumba vac√≠a es prueba de su victoria.', fruit: 'Fe' },
          { title: '2¬∫ La Ascensi√≥n', text: 'Jes√∫s sube al cielo ante sus disc√≠pulos. Va a prepararnos un lugar junto al Padre.', fruit: 'Esperanza' },
          { title: '3¬∫ La Venida del Esp√≠ritu Santo', text: 'El Esp√≠ritu Santo desciende sobre los ap√≥stoles en Pentecost√©s. La Iglesia nace con poder y fuego.', fruit: 'Amor de Dios' },
          { title: '4¬∫ La Asunci√≥n de Mar√≠a', text: 'Mar√≠a es llevada al cielo en cuerpo y alma. Su fidelidad es recompensada con la gloria celestial.', fruit: 'Gracia de una Buena Muerte' },
          { title: '5¬∫ La Coronaci√≥n de Mar√≠a', text: 'Mar√≠a es coronada Reina del cielo y la tierra. Intercede por nosotros como Madre y Reina.', fruit: 'Confianza en Mar√≠a' }
        ]
      },
      luminous: {
        name: 'Misterios Luminosos', day: 'Jueves',
        mysteries: [
          { title: '1¬∫ El Bautismo de Jes√∫s', text: 'Jes√∫s es bautizado en el Jord√°n. El Padre proclama: "Este es mi Hijo amado." El Esp√≠ritu desciende como paloma.', fruit: 'Apertura al Esp√≠ritu Santo' },
          { title: '2¬∫ Las Bodas de Can√°', text: 'Jes√∫s realiza su primer milagro por intercesi√≥n de Mar√≠a. "Hagan lo que √âl les diga" - palabras para toda la vida.', fruit: 'Fidelidad' },
          { title: '3¬∫ El Anuncio del Reino', text: 'Jes√∫s proclama el Reino de Dios y llama a la conversi√≥n. Las bienaventuranzas son el camino de la felicidad verdadera.', fruit: 'Conversi√≥n' },
          { title: '4¬∫ La Transfiguraci√≥n', text: 'Jes√∫s se transfigura en el monte, mostrando su gloria divina. Pedro, Santiago y Juan ven un destello del cielo.', fruit: 'Deseo de Santidad' },
          { title: '5¬∫ La Instituci√≥n de la Eucarist√≠a', text: 'Jes√∫s nos da su Cuerpo y Sangre en la √öltima Cena. "Hagan esto en memoria m√≠a" - el mayor regalo de amor.', fruit: 'Adoraci√≥n Eucar√≠stica' }
        ]
      }
    };

    // COMPLETE PRAYERS
    var PRAYERS = {
      padre_nuestro: { title: "Padre Nuestro", subtitle: "La Oraci√≥n del Se√±or", content: '<p><strong>Padre nuestro, que est√°s en el cielo,</strong><br>santificado sea tu Nombre;<br>venga a nosotros tu reino;<br>h√°gase tu voluntad en la tierra como en el cielo.<br><br>Danos hoy nuestro pan de cada d√≠a;<br>perdona nuestras ofensas,<br>como tambi√©n nosotros perdonamos a los que nos ofenden;<br>no nos dejes caer en la tentaci√≥n,<br>y l√≠branos del mal.<br><br><strong>Am√©n.</strong></p>' },
      ave_maria: { title: "Ave Mar√≠a", subtitle: "Salutaci√≥n Ang√©lica", content: '<p><strong>Dios te salve, Mar√≠a, llena eres de gracia;</strong><br>el Se√±or es contigo.<br>Bendita t√∫ eres entre todas las mujeres,<br>y bendito es el fruto de tu vientre, Jes√∫s.<br><br><strong>Santa Mar√≠a, Madre de Dios,</strong><br>ruega por nosotros, pecadores,<br>ahora y en la hora de nuestra muerte.<br><br><strong>Am√©n.</strong></p>' },
      gloria: { title: "Gloria al Padre", subtitle: "Doxolog√≠a Menor", content: '<p><strong>Gloria al Padre, y al Hijo, y al Esp√≠ritu Santo.</strong><br><br>Como era en el principio, ahora y siempre,<br>por los siglos de los siglos.<br><br><strong>Am√©n.</strong></p>' },
      credo: { title: "Credo", subtitle: "S√≠mbolo de los Ap√≥stoles", content: '<p><strong>Creo en Dios, Padre todopoderoso,</strong><br>Creador del cielo y de la tierra.<br><br>Creo en Jesucristo, su √∫nico Hijo, nuestro Se√±or,<br>que fue concebido por obra y gracia del Esp√≠ritu Santo,<br>naci√≥ de Santa Mar√≠a Virgen,<br>padeci√≥ bajo el poder de Poncio Pilato,<br>fue crucificado, muerto y sepultado,<br>descendi√≥ a los infiernos,<br>al tercer d√≠a resucit√≥ de entre los muertos,<br>subi√≥ a los cielos<br>y est√° sentado a la derecha de Dios, Padre todopoderoso.<br>Desde all√≠ ha de venir a juzgar a vivos y muertos.<br><br>Creo en el Esp√≠ritu Santo,<br>la santa Iglesia cat√≥lica,<br>la comuni√≥n de los santos,<br>el perd√≥n de los pecados,<br>la resurrecci√≥n de la carne<br>y la vida eterna.<br><br><strong>Am√©n.</strong></p>' },
      acto_contricion: { title: "Acto de Contrici√≥n", subtitle: "Oraci√≥n de Arrepentimiento", content: '<p><strong>Se√±or m√≠o Jesucristo,</strong><br>Dios y Hombre verdadero,<br>Creador, Padre y Redentor m√≠o;<br>por ser Vos quien sois, Bondad infinita,<br>y porque os amo sobre todas las cosas,<br>me pesa de todo coraz√≥n haberos ofendido;<br>tambi√©n me pesa porque pod√©is castigarme<br>con las penas del infierno.<br><br>Ayudado de vuestra divina gracia,<br>propongo firmemente nunca m√°s pecar,<br>confesarme y cumplir la penitencia que me fuere impuesta.<br><br><strong>Am√©n.</strong></p>' },
      san_miguel: { title: "Oraci√≥n a San Miguel Arc√°ngel", subtitle: "Defensa contra el mal", content: '<p><strong>San Miguel Arc√°ngel,</strong><br>defi√©ndenos en la batalla.<br>S√© nuestro amparo contra la perversidad<br>y asechanzas del demonio.<br><br>Repr√≠male Dios, pedimos suplicantes,<br>y t√∫, Pr√≠ncipe de la Milicia Celestial,<br>arroja al infierno con el divino poder<br>a Satan√°s y a los otros esp√≠ritus malignos<br>que andan dispersos por el mundo<br>para la perdici√≥n de las almas.<br><br><strong>Am√©n.</strong></p>' },
      magnificat: { title: "Magnificat", subtitle: "C√°ntico de Mar√≠a (Lucas 1:46-55)", content: '<p><strong>Proclama mi alma la grandeza del Se√±or,</strong><br>se alegra mi esp√≠ritu en Dios, mi salvador;<br>porque ha mirado la humillaci√≥n de su esclava.<br><br>Desde ahora me felicitar√°n todas las generaciones,<br>porque el Poderoso ha hecho obras grandes por m√≠:<br>su nombre es santo,<br>y su misericordia llega a sus fieles<br>de generaci√≥n en generaci√≥n.<br><br>√âl hace proezas con su brazo:<br>dispersa a los soberbios de coraz√≥n,<br>derriba del trono a los poderosos<br>y enaltece a los humildes,<br>a los hambrientos los colma de bienes<br>y a los ricos los despide vac√≠os.<br><br>Auxilia a Israel, su siervo,<br>acord√°ndose de la misericordia<br>‚Äîcomo lo hab√≠a prometido a nuestros padres‚Äî<br>en favor de Abrah√°n y su descendencia por siempre.<br><br><strong>Gloria al Padre, y al Hijo, y al Esp√≠ritu Santo...</strong></p>' },
      salve: { title: "Salve Regina", subtitle: "Ant√≠fona Mariana", content: '<p><strong>Dios te salve, Reina y Madre de misericordia,</strong><br>vida, dulzura y esperanza nuestra;<br>Dios te salve.<br><br>A ti llamamos los desterrados hijos de Eva;<br>a ti suspiramos, gimiendo y llorando<br>en este valle de l√°grimas.<br><br>Ea, pues, Se√±ora, abogada nuestra,<br>vuelve a nosotros esos tus ojos misericordiosos;<br>y despu√©s de este destierro,<br>mu√©stranos a Jes√∫s, fruto bendito de tu vientre.<br><br>¬°Oh clement√≠sima, oh piadosa,<br>oh dulce Virgen Mar√≠a!<br><br><strong>V.</strong> Ruega por nosotros, Santa Madre de Dios.<br><strong>R.</strong> Para que seamos dignos de alcanzar las promesas de Cristo.<br><br><strong>Am√©n.</strong></p>' },
      sub_tuum: { title: "Sub Tuum Praesidium", subtitle: "Bajo tu amparo (siglo III)", content: '<p><strong>Bajo tu amparo nos acogemos,</strong><br>Santa Madre de Dios;<br>no deseches las s√∫plicas<br>que te dirigimos en nuestras necesidades,<br>antes bien, l√≠branos de todo peligro,<br>¬°oh Virgen gloriosa y bendita!<br><br><em>Sub tuum praesidium confugimus,<br>Sancta Dei Genetrix.<br>Nostras deprecationes ne despicias<br>in necessitatibus,<br>sed a periculis cunctis<br>libera nos semper,<br>Virgo gloriosa et benedicta.</em><br><br><strong>Am√©n.</strong></p>' },
      requiem: { title: "Oraci√≥n por los Difuntos", subtitle: "R√©quiem Aet√©rnam", content: '<p><strong>Dales, Se√±or, el descanso eterno,</strong><br>y brille para ellos la luz perpetua.<br>Descansen en paz.<br><br><em>R√©quiem √¶t√©rnam dona eis, D√≥mine,<br>et lux perp√©tua l√∫ceat eis.<br>Requi√©scant in pace.</em><br><br><strong>Am√©n.</strong></p>' },
      ven_espiritu: { title: "Ven, Esp√≠ritu Santo", subtitle: "Invocaci√≥n al Par√°clito", content: '<p><strong>Ven, Esp√≠ritu Santo,</strong><br>llena los corazones de tus fieles<br>y enciende en ellos el fuego de tu amor.<br><br><strong>V.</strong> Env√≠a tu Esp√≠ritu y ser√°n creados.<br><strong>R.</strong> Y renovar√°s la faz de la tierra.<br><br><strong>Oremos:</strong><br>Oh Dios, que has instruido los corazones de tus fieles<br>con la luz del Esp√≠ritu Santo,<br>conc√©denos que sintamos rectamente con el mismo Esp√≠ritu<br>y gocemos siempre de su divino consuelo.<br>Por Jesucristo Nuestro Se√±or.<br><br><strong>Am√©n.</strong></p>' },
      anima_christi: { title: "Anima Christi", subtitle: "Alma de Cristo", content: '<p><strong>Alma de Cristo, santif√≠came.</strong><br>Cuerpo de Cristo, s√°lvame.<br>Sangre de Cristo, embri√°game.<br>Agua del costado de Cristo, l√°vame.<br>Pasi√≥n de Cristo, conf√≥rtame.<br><br>Oh buen Jes√∫s, √≥yeme.<br>Dentro de tus llagas, esc√≥ndeme.<br>No permitas que me aparte de Ti.<br>Del enemigo, defi√©ndeme.<br>En la hora de mi muerte, ll√°mame.<br>Y m√°ndame ir a Ti,<br>para que con tus Santos te alabe<br>por los siglos de los siglos.<br><br><strong>Am√©n.</strong></p>' },
      divine_mercy: { title: "Coronilla de la Divina Misericordia", subtitle: "", content: '<h4>En las cuentas del Padre Nuestro:</h4><p><strong>Padre Eterno, te ofrezco el Cuerpo y la Sangre, el Alma y la Divinidad de tu Amad√≠simo Hijo, nuestro Se√±or Jesucristo, como propiciaci√≥n de nuestros pecados y los del mundo entero.</strong></p><h4>En las cuentas del Ave Mar√≠a (10 veces):</h4><p><strong>Por Su dolorosa Pasi√≥n, ten misericordia de nosotros y del mundo entero.</strong></p><h4>Al final (3 veces):</h4><p><strong>Santo Dios, Santo Fuerte, Santo Inmortal, ten piedad de nosotros y del mundo entero.</strong></p>' },
      litany_saints: { title: "Litaniae Sanctorum", subtitle: "Letan√≠a de los Santos", content: '<div class="litany-section"><h4>Invocationes</h4><div class="litany-line"><span class="litany-call">Kyrie, eleison</span><span class="litany-response">Kyrie, eleison</span></div><div class="litany-line"><span class="litany-call">Christe, eleison</span><span class="litany-response">Christe, eleison</span></div><div class="litany-line"><span class="litany-call">Kyrie, eleison</span><span class="litany-response">Kyrie, eleison</span></div></div><div class="litany-section"><h4>Sancta Maria</h4><div class="litany-line"><span class="litany-call">Sancta Maria, Mater Dei</span><span class="litany-response">ora pro nobis</span></div><div class="litany-line"><span class="litany-call">Sancte Michael</span><span class="litany-response">ora pro nobis</span></div><div class="litany-line"><span class="litany-call">Sancte Ioseph</span><span class="litany-response">ora pro nobis</span></div></div><div class="litany-section"><h4>Apostoli</h4><div class="litany-line"><span class="litany-call">Sancte Petre et Paule</span><span class="litany-response">orate pro nobis</span></div><div class="litany-line"><span class="litany-call">Omnes Sancti Apostoli</span><span class="litany-response">orate pro nobis</span></div></div><div class="litany-section"><h4>Sancti et Sanctae</h4><div class="litany-line"><span class="litany-call">Sancta Maria Magdalena</span><span class="litany-response">ora pro nobis</span></div><div class="litany-line"><span class="litany-call">Sancte Augustine</span><span class="litany-response">ora pro nobis</span></div><div class="litany-line"><span class="litany-call">Sancte Francisce</span><span class="litany-response">ora pro nobis</span></div><div class="litany-line"><span class="litany-call">Sancta Teresia</span><span class="litany-response">ora pro nobis</span></div><div class="litany-line"><span class="litany-call">Omnes Sancti et Sanctae Dei</span><span class="litany-response">orate pro nobis</span></div></div><div class="litany-section"><p><strong>Agnus Dei, qui tollis peccata mundi,</strong> <span class="litany-response">parce nobis, Domine.</span><br><strong>Agnus Dei, qui tollis peccata mundi,</strong> <span class="litany-response">exaudi nos, Domine.</span><br><strong>Agnus Dei, qui tollis peccata mundi,</strong> <span class="litany-response">miserere nobis.</span></p></div>' },
      rosary_joyful: { title: "Misterios Gozosos", subtitle: "Lunes y S√°bado", isRosary: true, mysteryType: 'joyful' },
      rosary_sorrowful: { title: "Misterios Dolorosos", subtitle: "Martes y Viernes", isRosary: true, mysteryType: 'sorrowful' },
      rosary_glorious: { title: "Misterios Gloriosos", subtitle: "Mi√©rcoles y Domingo", isRosary: true, mysteryType: 'glorious' },
      rosary_luminous: { title: "Misterios Luminosos", subtitle: "Jueves", isRosary: true, mysteryType: 'luminous' }
    };
    
    // 2026 CALENDAR WITH FEASTS
    var MONTHS = [
      { name: 'Enero', theme: 'Nombre de Jes√∫s', scripture: '"Al nombre de Jes√∫s toda rodilla se doble."', ref: 'Filipenses 2:10', feasts: [{ date: 1, name: 'Santa Mar√≠a, Madre de Dios' }, { date: 6, name: 'Epifan√≠a del Se√±or' }]},
      { name: 'Febrero', theme: 'Conversi√≥n', scripture: '"Convi√©rtanse y crean en el Evangelio."', ref: 'Marcos 1:15', feasts: [{ date: 2, name: 'Presentaci√≥n del Se√±or' }, { date: 11, name: 'Nuestra Se√±ora de Lourdes' }, { date: 18, name: 'Mi√©rcoles de Ceniza' }]},
      { name: 'Marzo', theme: 'Cuaresma', scripture: '"Ni√©guese a s√≠ mismo y tome su cruz."', ref: 'Mateo 16:24', feasts: [{ date: 19, name: 'San Jos√©' }, { date: 25, name: 'Anunciaci√≥n del Se√±or' }, { date: 29, name: 'Domingo de Ramos' }]},
      { name: 'Abril', theme: 'Pascua', scripture: '"¬°Ha resucitado!"', ref: 'Mateo 28:6', feasts: [{ date: 2, name: 'Jueves Santo' }, { date: 3, name: 'Viernes Santo' }, { date: 5, name: 'Domingo de Pascua' }]},
      { name: 'Mayo', theme: 'Mes de Mar√≠a', scripture: '"H√°gase en m√≠ seg√∫n tu palabra."', ref: 'Lucas 1:38', feasts: [{ date: 1, name: 'San Jos√© Obrero' }, { date: 13, name: 'Nuestra Se√±ora de F√°tima' }, { date: 24, name: 'Pentecost√©s' }, { date: 31, name: 'Visitaci√≥n de Mar√≠a' }]},
      { name: 'Junio', theme: 'Sagrado Coraz√≥n', scripture: '"Vengan a m√≠ todos los que est√°n cansados."', ref: 'Mateo 11:28', feasts: [{ date: 7, name: 'Corpus Christi' }, { date: 12, name: 'Sagrado Coraz√≥n de Jes√∫s' }, { date: 24, name: 'Natividad de San Juan Bautista' }]},
      { name: 'Julio', theme: 'Presencia de Dios', scripture: '"Permanezcan en m√≠."', ref: 'Juan 15:4', feasts: [{ date: 16, name: 'Virgen del Carmen' }, { date: 22, name: 'Santa Mar√≠a Magdalena' }, { date: 25, name: 'Santiago Ap√≥stol' }]},
      { name: 'Agosto', theme: 'Asunci√≥n', scripture: '"Engrandece mi alma al Se√±or."', ref: 'Lucas 1:46', feasts: [{ date: 6, name: 'Transfiguraci√≥n del Se√±or' }, { date: 15, name: 'Asunci√≥n de Mar√≠a' }]},
      { name: 'Septiembre', theme: 'Dolores de Mar√≠a', scripture: '"Junto a la cruz estaba su madre."', ref: 'Juan 19:25', feasts: [{ date: 8, name: 'Natividad de Mar√≠a' }, { date: 14, name: 'Exaltaci√≥n de la Santa Cruz' }, { date: 15, name: 'Nuestra Se√±ora de los Dolores' }]},
      { name: 'Octubre', theme: 'Santo Rosario', scripture: '"Dios te salve, llena de gracia."', ref: 'Lucas 1:28', feasts: [{ date: 4, name: 'San Francisco de As√≠s' }, { date: 7, name: 'Nuestra Se√±ora del Rosario' }, { date: 15, name: 'Santa Teresa de Jes√∫s' }]},
      { name: 'Noviembre', theme: 'Comuni√≥n de Santos', scripture: '"Bienaventurados los que lloran."', ref: 'Mateo 5:4', feasts: [{ date: 1, name: 'Todos los Santos' }, { date: 2, name: 'Fieles Difuntos' }, { date: 22, name: 'Cristo Rey' }]},
      { name: 'Diciembre', theme: 'Adviento y Navidad', scripture: '"El Verbo se hizo carne."', ref: 'Juan 1:14', feasts: [{ date: 8, name: 'Inmaculada Concepci√≥n' }, { date: 12, name: 'Nuestra Se√±ora de Guadalupe' }, { date: 25, name: 'Navidad del Se√±or' }]}
    ];
    
    var GOAL_CATEGORIES = [
      { id: 'spiritual', title: 'üïäÔ∏è Vida Espiritual' },
      { id: 'family', title: 'üíñ Familia y Relaciones' },
      { id: 'personal', title: 'üåø Personal y Emocional' }
    ];
    
    // DATA
    var data = { 
      lectios: [], intentions: [], monthlyGoals: {}, readChapters: [], 
      currentMonth: 0, // START IN JANUARY
      dailyPrayers: {}, rosaryProgress: {}, journal: [], prayerHistory: []
    };
    var currentTab = 'lectio';
    var expandedCard = null;
    var selectedReadingType = 'random';
    var pendingReading = null;
    var currentPrayer = 'padre_nuestro';
    
    function init() {
      var saved = localStorage.getItem('spiritual-planner-v10');
      if (saved) { 
        data = JSON.parse(saved); 
        if (!data.readChapters) data.readChapters = []; 
        if (!data.monthlyGoals) data.monthlyGoals = {};
        if (!data.dailyPrayers) data.dailyPrayers = {};
        if (!data.rosaryProgress) data.rosaryProgress = {};
        if (!data.journal) data.journal = [];
        if (!data.prayerHistory) data.prayerHistory = [];
        if (data.currentMonth === undefined) data.currentMonth = 0;
      }
      updateTodayHeader();
      populateBookSelect();
      render();
    }
    
    function save() { localStorage.setItem('spiritual-planner-v10', JSON.stringify(data)); }
    
    function getTodayKey() { return new Date().toISOString().slice(0, 10); }
    
    function formatDateLong(date) {
      var days = ['Domingo', 'Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado'];
      var months = ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'];
      return days[date.getDay()] + ', ' + date.getDate() + ' de ' + months[date.getMonth()] + ' de ' + date.getFullYear();
    }
    
    function updateTodayHeader() {
      var today = new Date();
      document.getElementById('todayDate').textContent = formatDateLong(today);
      var month = MONTHS[today.getMonth()];
      var todayFeast = month.feasts.find(function(f) { return f.date === today.getDate(); });
      document.getElementById('todayFeast').textContent = todayFeast ? '‚ú® ' + todayFeast.name : 'üìø ' + month.theme;
    }
    
    function showStatus(msg, type) {
      var el = document.getElementById('statusMsg');
      el.textContent = msg; el.className = 'status-msg ' + type; el.style.display = 'block';
      setTimeout(function() { el.style.display = 'none'; }, 3000);
    }
    
    function getBookProgress(bookAbbr) {
      var book = BIBLE_BOOKS.find(function(b) { return b.abbr === bookAbbr; });
      if (!book) return 0;
      var read = 0;
      for (var ch = 1; ch <= book.chapters; ch++) {
        if (data.readChapters.indexOf(bookAbbr + '-' + ch) !== -1) read++;
      }
      return Math.round((read / book.chapters) * 100);
    }
    
    function populateBookSelect() {
      var select = document.getElementById('bookSelect');
      if (!select) return;
      select.innerHTML = BIBLE_BOOKS.map(function(b) { return '<option value="' + b.abbr + '">' + b.name + '</option>'; }).join('');
      updateChapters();
    }
    
    function updateChapters() {
      var bookAbbr = document.getElementById('bookSelect').value;
      var book = BIBLE_BOOKS.find(function(b) { return b.abbr === bookAbbr; });
      if (!book) return;
      var select = document.getElementById('chapterSelect');
      var options = [];
      for (var ch = 1; ch <= book.chapters; ch++) {
        var isRead = data.readChapters.indexOf(bookAbbr + '-' + ch) !== -1;
        options.push('<option value="' + ch + '">' + ch + (isRead ? ' ‚úì' : '') + '</option>');
      }
      select.innerHTML = options.join('');
    }
    
    function getRandomUnreadChapter(filter) {
      var candidates = [];
      BIBLE_BOOKS.forEach(function(book) {
        if (filter && book.type !== filter) return;
        for (var ch = 1; ch <= book.chapters; ch++) {
          var key = book.abbr + '-' + ch;
          if (data.readChapters.indexOf(key) === -1) candidates.push({ book: book, chapter: ch, key: key });
        }
      });
      if (candidates.length === 0) return null;
      return candidates[Math.floor(Math.random() * candidates.length)];
    }
    
    function selectReadingType(type) {
      selectedReadingType = type;
      document.querySelectorAll('.reading-option').forEach(function(el) { el.classList.remove('selected'); });
      event.target.classList.add('selected');
      var manualSelect = document.getElementById('manualSelect');
      var selectedDiv = document.getElementById('selectedReading');
      if (type === 'manual') {
        manualSelect.style.display = 'block';
        selectedDiv.style.display = 'none';
        pendingReading = null;
      } else {
        manualSelect.style.display = 'none';
        var filter = type === 'random' ? null : type;
        var reading = getRandomUnreadChapter(filter);
        pendingReading = reading;
        selectedDiv.style.display = 'block';
        document.getElementById('selectedReadingText').textContent = reading ? reading.book.name + ' ' + reading.chapter : '¬°Todo le√≠do!';
      }
    }
    
    function startLectio() {
      var reading;
      if (selectedReadingType === 'manual') {
        var bookAbbr = document.getElementById('bookSelect').value;
        var chapter = parseInt(document.getElementById('chapterSelect').value);
        var book = BIBLE_BOOKS.find(function(b) { return b.abbr === bookAbbr; });
        reading = { book: book, chapter: chapter, key: bookAbbr + '-' + chapter };
      } else {
        reading = pendingReading;
      }
      if (!reading) { alert('Selecciona una lectura'); return; }
      
      if (data.readChapters.indexOf(reading.key) === -1) data.readChapters.push(reading.key);
      
      data.lectios.push({
        id: Date.now(), date: getTodayKey(), timestamp: new Date().toISOString(),
        bookAbbr: reading.book.abbr, bookName: reading.book.name, usccb: reading.book.usccb,
        chapter: reading.chapter, reference: reading.book.name + ' ' + reading.chapter,
        lectio: '', meditatio: '', oratio: '', contemplatio: ''
      });
      
      logPrayer('Lectio Divina: ' + reading.book.name + ' ' + reading.chapter);
      save(); closeModal('lectioModal');
      expandedCard = 'lectio-' + data.lectios[data.lectios.length - 1].id;
      render();
    }
    
    function logPrayer(prayerName) {
      var now = new Date();
      data.prayerHistory.push({
        date: getTodayKey(),
        time: now.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' }),
        prayer: prayerName,
        timestamp: now.toISOString()
      });
      save();
    }
    
    function getStreak() {
      var streak = 0;
      var today = new Date(); today.setHours(0,0,0,0);
      for (var i = 0; i < 365; i++) {
        var checkDate = new Date(today); checkDate.setDate(checkDate.getDate() - i);
        var dateStr = checkDate.toISOString().slice(0, 10);
        if (data.lectios.some(function(l) { return l.date === dateStr; })) streak++;
        else if (i > 0) break;
      }
      return streak;
    }
    
    function getTodayLectios() {
      return data.lectios.filter(function(l) { return l.date === getTodayKey(); });
    }
    
    function getTotalChapters() {
      return BIBLE_BOOKS.reduce(function(sum, b) { return sum + b.chapters; }, 0);
    }
    
    function renderDashboard() {
      var streak = getStreak();
      var totalChapters = getTotalChapters();
      var progress = Math.round((data.readChapters.length / totalChapters) * 100);
      document.getElementById('dashboard').innerHTML = 
        '<div class="stat"><div class="stat-num" style="color:#E85D4C;">‚ô• ' + streak + '</div><div class="stat-label">D√≠as Seguidos</div></div>' +
        '<div class="stat"><div class="stat-num" style="color:#F4C430;">' + getTodayLectios().length + '</div><div class="stat-label">Lectio Hoy</div></div>' +
        '<div class="stat"><div class="stat-num" style="color:#2A9D8F;">' + progress + '%</div><div class="stat-label">Biblia</div><div class="progress-bar"><div class="progress-fill" style="width:' + progress + '%;"></div></div></div>' +
        '<div class="stat"><div class="stat-num" style="color:#6B8EAE;">' + data.journal.length + '</div><div class="stat-label">Diario</div></div>';
    }
    
    function renderTabs() {
      var tabs = [
        { id: 'lectio', label: 'üìñ Lectio' },
        { id: 'prayers', label: 'üôè Oraciones' },
        { id: 'intentions', label: 'üíù Intenciones' },
        { id: 'journal', label: 'üìù Diario' },
        { id: 'bible', label: 'üìö Biblia' },
        { id: 'history', label: 'üìä Historial' },
        { id: 'month', label: 'üìÖ Calendario' }
      ];
      document.getElementById('tabs').innerHTML = tabs.map(function(t) {
        return '<button class="tab ' + (currentTab === t.id ? 'active' : '') + '" onclick="setTab(\'' + t.id + '\')">' + t.label + '</button>';
      }).join('');
    }
    
    function setTab(tab) { currentTab = tab; expandedCard = null; render(); }
    
    function render() {
      renderDashboard();
      renderTabs();
      var content = document.getElementById('content');
      if (currentTab === 'lectio') content.innerHTML = renderLectioTab();
      else if (currentTab === 'prayers') content.innerHTML = renderPrayersTab();
      else if (currentTab === 'intentions') content.innerHTML = renderIntentionsTab();
      else if (currentTab === 'journal') content.innerHTML = renderJournalTab();
      else if (currentTab === 'bible') content.innerHTML = renderBibleTab();
      else if (currentTab === 'history') content.innerHTML = renderHistoryTab();
      else if (currentTab === 'month') content.innerHTML = renderMonthTab();
    }
    
    function renderLectioTab() {
      var html = '<div style="text-align:center;margin-bottom:16px;"><button class="btn btn-primary" onclick="openLectioModal()">üìñ Nueva Lectio Divina</button></div>';
      
      // Daily Prayer Tracker with Date
      var today = new Date();
      html += '<div class="daily-prayers-tracker"><div class="daily-prayers-title">‚ú® Oraciones de Hoy</div><div class="daily-prayers-date">' + formatDateLong(today) + '</div>';
      
      var prayers = [
        { id: 'lectio', name: 'Lectio Divina', done: getTodayLectios().length > 0 },
        { id: 'rosary', name: 'Santo Rosario' },
        { id: 'coronilla', name: 'Coronilla de la Divina Misericordia' },
        { id: 'liturgia', name: 'Liturgia de las Horas' },
        { id: 'examen', name: 'Examen de Conciencia' }
      ];
      
      prayers.forEach(function(p) {
        var isDone = p.done || (data.dailyPrayers[getTodayKey()] && data.dailyPrayers[getTodayKey()][p.id]);
        html += '<div class="daily-prayer-item"><div class="daily-prayer-check ' + (isDone ? 'done' : '') + '" onclick="toggleDailyPrayer(\'' + p.id + '\')">' + (isDone ? '‚úì' : '') + '</div><span class="daily-prayer-label">' + p.name + '</span></div>';
      });
      html += '</div>';
      
      var sorted = data.lectios.slice().sort(function(a, b) { return (b.timestamp || b.date).localeCompare(a.timestamp || a.date); });
      if (sorted.length === 0) {
        html += '<div class="empty-state">A√∫n no tienes entradas de Lectio Divina.</div>';
      } else {
        html += sorted.slice(0, 10).map(function(l) {
          var isExp = expandedCard === 'lectio-' + l.id;
          var dateObj = new Date(l.date + 'T12:00:00');
          var dateStr = dateObj.toLocaleDateString('es-ES', { weekday: 'long', day: 'numeric', month: 'long' });
          var usccbEs = 'https://bible.usccb.org/es/bible/' + l.usccb + '/' + l.chapter;
          var usccbEn = 'https://bible.usccb.org/bible/' + l.usccb + '/' + l.chapter;
          
          return '<div class="card lectio-card ' + (isExp ? 'expanded' : '') + '">' +
            '<div class="card-header" onclick="toggleCard(\'lectio-' + l.id + '\')">' + chevronSVG +
              '<div style="flex:1;"><div class="lectio-date">' + dateStr + '</div><div class="lectio-reading">üìú ' + l.reference + '</div></div></div>' +
            '<div class="card-body">' +
              '<div class="scripture-display"><div class="scripture-reference">üìñ ' + l.reference + '</div><a href="' + usccbEs + '" target="_blank" class="scripture-link">üá™üá∏ Leer en Espa√±ol</a><a href="' + usccbEn + '" target="_blank" class="scripture-link" style="background:#6B8EAE;">üá∫üá∏ Read in English</a></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üìñ 1. Lectio ‚Äî ¬øQu√© dice el texto?</div><textarea class="lectio-textarea" placeholder="¬øQu√© palabras o frases te llaman la atenci√≥n?" onchange="updateLectio(' + l.id + ', \'lectio\', this.value)">' + escapeHtml(l.lectio || '') + '</textarea></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üí≠ 2. Meditatio ‚Äî ¬øQu√© me dice a m√≠?</div><textarea class="lectio-textarea" placeholder="¬øQu√© me dice el Se√±or personalmente?" onchange="updateLectio(' + l.id + ', \'meditatio\', this.value)">' + escapeHtml(l.meditatio || '') + '</textarea></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üôè 3. Oratio ‚Äî Mi respuesta a Dios</div><textarea class="lectio-textarea" placeholder="Tu oraci√≥n en respuesta a la Palabra..." onchange="updateLectio(' + l.id + ', \'oratio\', this.value)">' + escapeHtml(l.oratio || '') + '</textarea></div>' +
              '<div class="lectio-section"><div class="lectio-section-title">üå∏ 4. Contemplatio ‚Äî Descansar en Dios</div><textarea class="lectio-textarea" placeholder="Simplemente estar con Dios en silencio..." onchange="updateLectio(' + l.id + ', \'contemplatio\', this.value)">' + escapeHtml(l.contemplatio || '') + '</textarea></div>' +
              '<div style="text-align:right;margin-top:12px;"><button class="btn btn-danger btn-small" onclick="deleteLectio(' + l.id + ')">üóëÔ∏è Eliminar</button></div>' +
            '</div></div>';
        }).join('');
      }
      return html;
    }
    
    function renderPrayersTab() {
      var prayerOrder = ['padre_nuestro', 'ave_maria', 'gloria', 'credo', 'acto_contricion', 'san_miguel', 'magnificat', 'salve', 'sub_tuum', 'ven_espiritu', 'anima_christi', 'divine_mercy', 'requiem', 'litany_saints', 'rosary_joyful', 'rosary_sorrowful', 'rosary_glorious', 'rosary_luminous'];
      
      var html = '<div class="prayer-nav">' +
        prayerOrder.map(function(key) {
          var labels = { padre_nuestro: 'Padre Nuestro', ave_maria: 'Ave Mar√≠a', gloria: 'Gloria', credo: 'Credo', acto_contricion: 'Contrici√≥n', san_miguel: 'San Miguel', magnificat: 'Magnificat', salve: 'Salve', sub_tuum: 'Sub Tuum', ven_espiritu: 'Esp√≠ritu Santo', anima_christi: 'Anima Christi', divine_mercy: 'Coronilla', requiem: 'Difuntos', litany_saints: 'Letan√≠a', rosary_joyful: 'Gozosos', rosary_sorrowful: 'Dolorosos', rosary_glorious: 'Gloriosos', rosary_luminous: 'Luminosos' };
          return '<button class="prayer-nav-btn ' + (currentPrayer === key ? 'active' : '') + '" onclick="setPrayer(\'' + key + '\')">' + labels[key] + '</button>';
        }).join('') + '</div>';
      
      var prayer = PRAYERS[currentPrayer];
      
      if (prayer.isRosary) {
        html += renderRosaryMysteries(prayer.mysteryType);
      } else {
        html += '<div class="card prayer-card expanded"><div class="card-body" style="display:block;"><div class="prayer-title">' + prayer.title + '</div><div class="prayer-subtitle">' + prayer.subtitle + '</div><div class="prayer-content" style="margin-top:16px;">' + prayer.content + '</div>';
        html += '<div style="text-align:center;margin-top:20px;"><button class="btn btn-primary" onclick="markPrayerComplete(\'' + prayer.title + '\')">‚úì Marcar como Rezado</button></div>';
        html += '</div></div>';
      }
      return html;
    }
    
    function renderRosaryMysteries(mysteryType) {
      var mystery = ROSARY_MYSTERIES[mysteryType];
      var today = getTodayKey();
      var rosaryKey = today + '-' + mysteryType;
      
      // Initialize rosary progress if not exists
      if (!data.rosaryProgress[rosaryKey]) {
        data.rosaryProgress[rosaryKey] = { 
          intro: [false, false, false, false, false], 
          decades: [
            [false,false,false,false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false,false,false,false]
          ]
        };
      }
      var progress = data.rosaryProgress[rosaryKey];
      
      // Count completed beads
      var totalBeads = 5 + 55; // intro + 5 decades of 11 each
      var doneBeads = progress.intro.filter(function(b) { return b; }).length;
      progress.decades.forEach(function(d) { doneBeads += d.filter(function(b) { return b; }).length; });
      var pct = Math.round((doneBeads / totalBeads) * 100);
      
      var html = '<div class="rosary-container">';
      html += '<div class="rosary-title">üìø ' + mystery.name + '</div>';
      html += '<p style="color:#9ca3af;text-align:center;font-size:12px;margin-bottom:16px;">' + mystery.day + ' ‚Ä¢ ' + pct + '% completado</p>';
      
      // Intro beads: Cross, Creed, Our Father, 3 Hail Marys, Glory
      html += '<div style="margin-bottom:20px;"><p style="color:#F4C430;font-size:11px;text-align:center;margin-bottom:8px;">Inicio: Credo, Padre Nuestro, 3 Ave Mar√≠as, Gloria</p>';
      html += '<div class="rosary-beads">';
      var introLabels = ['‚úù', 'C', 'PN', 'A', 'A'];
      for (var i = 0; i < 5; i++) {
        var isDone = progress.intro[i];
        html += '<div class="rosary-bead ' + (i === 0 ? 'large ' : '') + (isDone ? 'done' : '') + '" onclick="toggleRosaryBead(\'' + rosaryKey + '\', \'intro\', ' + i + ')">' + (isDone ? '‚úì' : introLabels[i]) + '</div>';
      }
      html += '</div></div>';
      
      // Five decades with mysteries
      for (var d = 0; d < 5; d++) {
        var m = mystery.mysteries[d];
        html += '<div style="margin-bottom:20px;">';
        html += '<div class="prayer-content"><div class="mystery"><div class="mystery-title">' + m.title + '</div><div class="mystery-meditation">' + m.text + '</div><div class="mystery-fruit">Fruto: ' + m.fruit + '</div></div></div>';
        html += '<div class="rosary-beads">';
        // Our Father bead (large)
        html += '<div class="rosary-bead large ' + (progress.decades[d][0] ? 'done' : '') + '" onclick="toggleRosaryBead(\'' + rosaryKey + '\', \'decade\', ' + d + ', 0)">' + (progress.decades[d][0] ? '‚úì' : 'PN') + '</div>';
        // 10 Hail Mary beads
        for (var b = 1; b <= 10; b++) {
          html += '<div class="rosary-bead ' + (progress.decades[d][b] ? 'done' : '') + '" onclick="toggleRosaryBead(\'' + rosaryKey + '\', \'decade\', ' + d + ', ' + b + ')">' + (progress.decades[d][b] ? '‚úì' : b) + '</div>';
        }
        html += '</div></div>';
      }
      
      // Complete button
      html += '<div style="text-align:center;margin-top:16px;">';
      if (pct === 100) {
        html += '<button class="btn btn-primary" onclick="markPrayerComplete(\'Rosario - ' + mystery.name + '\')">‚úì ¬°Rosario Completado! Registrar</button>';
      } else {
        html += '<p style="color:#9ca3af;font-size:12px;">Completa todas las cuentas para registrar el rosario</p>';
      }
      html += '</div></div>';
      
      return html;
    }
    
    function toggleRosaryBead(rosaryKey, section, index1, index2) {
      if (!data.rosaryProgress[rosaryKey]) return;
      if (section === 'intro') {
        data.rosaryProgress[rosaryKey].intro[index1] = !data.rosaryProgress[rosaryKey].intro[index1];
      } else {
        data.rosaryProgress[rosaryKey].decades[index1][index2] = !data.rosaryProgress[rosaryKey].decades[index1][index2];
      }
      save();
      render();
    }
    
    function markPrayerComplete(prayerName) {
      logPrayer(prayerName);
      showStatus('¬°' + prayerName + ' registrado!', 'success');
    }
    
    function setPrayer(key) { currentPrayer = key; render(); }
    
    function renderIntentionsTab() {
      var html = '<div style="text-align:center;margin-bottom:16px;"><button class="btn btn-primary" onclick="openModal(\'intentionModal\')">üíù Agregar Intenci√≥n</button></div>';
      
      var cats = [{ id: 'family', title: 'üë®‚Äçüë©‚Äçüëß Por mi familia' }, { id: 'spiritual', title: 'üïäÔ∏è Vida espiritual' }, { id: 'others', title: 'üôè Por otros' }, { id: 'thanksgiving', title: 'üíõ Acci√≥n de Gracias' }];
      cats.forEach(function(cat) {
        var items = data.intentions.filter(function(i) { return i.category === cat.id; });
        if (items.length > 0) {
          html += '<div class="goal-category"><div class="goal-category-title">' + cat.title + '</div>' +
            items.map(function(i) {
              return '<div class="intention-item"><div class="intention-check ' + (i.answered ? 'done' : '') + '" onclick="toggleIntention(' + i.id + ')">' + (i.answered ? '‚úì' : '') + '</div><span style="flex:1;font-size:13px;' + (i.answered ? 'text-decoration:line-through;color:#9ca3af;' : '') + '">' + escapeHtml(i.text) + '</span><button class="btn btn-danger btn-small" onclick="deleteIntention(' + i.id + ')">√ó</button></div>';
            }).join('') + '</div>';
        }
      });
      if (data.intentions.length === 0) html += '<div class="empty-state">"Pidan y se les dar√°" ‚Äî Mateo 7:7</div>';
      return html;
    }
    
    function renderJournalTab() {
      var html = '<div style="text-align:center;margin-bottom:16px;"><button class="btn btn-primary" onclick="openModal(\'journalModal\')">üìù Nueva Entrada</button></div>';
      
      if (data.journal.length === 0) {
        html += '<div class="empty-state">Tu diario espiritual est√° vac√≠o.<br>Comienza a escribir tus reflexiones diarias.</div>';
      } else {
        var sorted = data.journal.slice().sort(function(a, b) { return b.timestamp.localeCompare(a.timestamp); });
        sorted.forEach(function(entry) {
          var dateObj = new Date(entry.timestamp);
          html += '<div class="journal-entry"><div class="journal-date">' + formatDateLong(dateObj) + '</div>';
          if (entry.feeling) html += '<div class="journal-section"><div class="journal-section-title">üí≠ ¬øC√≥mo me sent√≠?</div><p style="font-size:14px;">' + escapeHtml(entry.feeling) + '</p></div>';
          if (entry.learned) html += '<div class="journal-section"><div class="journal-section-title">üìö ¬øQu√© aprend√≠?</div><p style="font-size:14px;">' + escapeHtml(entry.learned) + '</p></div>';
          if (entry.takeaway) html += '<div class="journal-section"><div class="journal-section-title">üåü Para llevar conmigo</div><p style="font-size:14px;">' + escapeHtml(entry.takeaway) + '</p></div>';
          html += '<div style="text-align:right;"><button class="btn btn-danger btn-small" onclick="deleteJournalEntry(\'' + entry.id + '\')">Eliminar</button></div></div>';
        });
      }
      return html;
    }
    
    function renderBibleTab() {
      var html = '<div class="bible-progress"><h3>üìö Progreso de Lectura de la Biblia</h3>';
      html += '<p style="font-size:13px;color:#6b7280;margin-bottom:16px;">Total: ' + data.readChapters.length + ' / ' + getTotalChapters() + ' cap√≠tulos (' + Math.round((data.readChapters.length / getTotalChapters()) * 100) + '%)</p>';
      
      html += '<div class="book-progress-grid">';
      BIBLE_BOOKS.forEach(function(book) {
        var pct = getBookProgress(book.abbr);
        html += '<div class="book-progress-item"><div class="book-progress-name">' + book.name + '</div><div class="book-progress-bar"><div class="book-progress-fill" style="width:' + pct + '%;"></div></div><div style="font-size:9px;color:#6b7280;">' + pct + '%</div></div>';
      });
      html += '</div></div>';
      
      return html;
    }
    
    function renderHistoryTab() {
      var html = '<div class="bible-progress"><h3>üìä Historial de Oraci√≥n</h3>';
      
      if (data.prayerHistory.length === 0) {
        html += '<div class="empty-state">A√∫n no hay historial.<br>Tus oraciones se registrar√°n aqu√≠.</div>';
      } else {
        // Group by date
        var byDate = {};
        data.prayerHistory.forEach(function(p) {
          if (!byDate[p.date]) byDate[p.date] = [];
          byDate[p.date].push(p);
        });
        
        var dates = Object.keys(byDate).sort().reverse();
        dates.slice(0, 30).forEach(function(date) {
          var dateObj = new Date(date + 'T12:00:00');
          var prayers = byDate[date];
          html += '<div class="prayer-history-item"><div class="prayer-history-date">' + formatDateLong(dateObj) + '</div><div class="prayer-history-prayers">';
          prayers.forEach(function(p) {
            html += '<div>üïê ' + p.time + ' ‚Äî ' + p.prayer + '</div>';
          });
          html += '</div></div>';
        });
      }
      html += '</div>';
      return html;
    }
    
    function renderMonthTab() {
      var month = MONTHS[data.currentMonth];
      var monthKey = 'month-' + data.currentMonth;
      var goals = data.monthlyGoals[monthKey] || [];
      
      var html = '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">' +
        '<button class="btn btn-secondary btn-small" onclick="changeMonth(-1)">‚Üê Anterior</button>' +
        '<h2 style="font-size:18px;color:#E85D4C;">' + month.name + ' 2026</h2>' +
        '<button class="btn btn-secondary btn-small" onclick="changeMonth(1)">Siguiente ‚Üí</button></div>' +
        '<div class="scripture-box"><p class="scripture-quote">' + month.scripture + '</p><p class="scripture-ref">' + month.ref + '</p></div>';
      
      // Goals
      html += '<div class="month-goals"><h3>‚ú® Metas de ' + month.name + '</h3>';
      html += '<div class="add-goal-row"><select class="add-goal-select" id="newGoalCategory">' +
        GOAL_CATEGORIES.map(function(c) { return '<option value="' + c.id + '">' + c.title + '</option>'; }).join('') +
        '</select><input type="text" class="add-goal-input" id="newGoalInput" placeholder="Nueva meta..." onkeypress="if(event.key===\'Enter\')addMonthlyGoal()"><button class="btn btn-primary btn-small" onclick="addMonthlyGoal()">+</button></div>';
      
      GOAL_CATEGORIES.forEach(function(cat) {
        var catGoals = goals.filter(function(g) { return g.category === cat.id; });
        if (catGoals.length > 0) {
          html += '<div class="goal-category"><div class="goal-category-title">' + cat.title + '</div>';
          catGoals.forEach(function(g) {
            html += '<div class="goal-item"><div class="goal-check ' + (g.done ? 'done' : '') + '" onclick="toggleMonthlyGoal(\'' + monthKey + '\', ' + g.id + ')">' + (g.done ? '‚úì' : '') + '</div><span class="goal-text ' + (g.done ? 'done' : '') + '">' + escapeHtml(g.text) + '</span><button class="btn btn-danger btn-small" onclick="deleteMonthlyGoal(\'' + monthKey + '\', ' + g.id + ')">√ó</button></div>';
          });
          html += '</div>';
        }
      });
      html += '</div>';
      
      // Feasts
      html += '<div class="month-goals"><h3>üéâ Fiestas de ' + month.name + '</h3>';
      month.feasts.forEach(function(f) {
        html += '<div style="padding:6px 0;border-bottom:1px dashed #e0e0e0;font-size:13px;"><strong style="color:#E85D4C;">' + f.date + '</strong> ‚Äî ' + f.name + '</div>';
      });
      html += '</div>';
      
      // Calendar
      html += '<div class="month-goals">' + renderCalendar(data.currentMonth) + '</div>';
      
      return html;
    }
    
    function renderCalendar(monthIndex) {
      var year = 2026, firstDay = new Date(year, monthIndex, 1), lastDay = new Date(year, monthIndex + 1, 0);
      var startDay = firstDay.getDay(), daysInMonth = lastDay.getDate();
      var today = new Date(), todayDate = today.getDate(), todayMonth = today.getMonth(), todayYear = today.getFullYear();
      var feastDays = MONTHS[monthIndex].feasts.map(function(f) { return f.date; });
      var days = ['Dom','Lun','Mar','Mi√©','Jue','Vie','S√°b'];
      var html = '<div class="calendar-grid">';
      days.forEach(function(d) { html += '<div class="calendar-header">' + d + '</div>'; });
      for (var i = 0; i < startDay; i++) html += '<div class="calendar-day empty"></div>';
      
      for (var d = 1; d <= daysInMonth; d++) {
        var isToday = d === todayDate && monthIndex === todayMonth && year === todayYear;
        var isFeast = feastDays.indexOf(d) !== -1;
        var cls = 'calendar-day' + (isToday ? ' today' : isFeast ? ' feast' : '');
        html += '<div class="' + cls + '">' + d + '</div>';
      }
      return html + '</div>';
    }
    
    function toggleDailyPrayer(id) {
      var today = getTodayKey();
      if (!data.dailyPrayers[today]) data.dailyPrayers[today] = {};
      data.dailyPrayers[today][id] = !data.dailyPrayers[today][id];
      if (data.dailyPrayers[today][id]) {
        var names = { rosary: 'Santo Rosario', coronilla: 'Coronilla', liturgia: 'Liturgia de las Horas', examen: 'Examen de Conciencia' };
        if (names[id]) logPrayer(names[id]);
      }
      save(); render();
    }
    
    function changeMonth(delta) { data.currentMonth = (data.currentMonth + delta + 12) % 12; save(); render(); }
    function toggleCard(cardId) { expandedCard = expandedCard === cardId ? null : cardId; render(); }
    function escapeHtml(str) { return str ? str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;') : ''; }
    function openModal(id) { document.getElementById(id).classList.add('open'); }
    function closeModal(id) { document.getElementById(id).classList.remove('open'); }
    
    function openLectioModal() {
      selectedReadingType = 'random';
      setTimeout(function() {
        document.querySelectorAll('.reading-option').forEach(function(el, i) { el.classList.toggle('selected', i === 0); });
        document.getElementById('manualSelect').style.display = 'none';
        var reading = getRandomUnreadChapter(null);
        pendingReading = reading;
        document.getElementById('selectedReading').style.display = 'block';
        document.getElementById('selectedReadingText').textContent = reading ? reading.book.name + ' ' + reading.chapter : '¬°Todo le√≠do!';
      }, 100);
      openModal('lectioModal');
    }
    
    function updateLectio(id, field, value) { 
      data.lectios = data.lectios.map(function(l) { if (l.id === id) l[field] = value; return l; }); 
      save(); 
    }
    
    function deleteLectio(id) { 
      event.stopPropagation();
      if (confirm('¬øEliminar esta entrada de Lectio Divina?')) { 
        data.lectios = data.lectios.filter(function(l) { return l.id !== id; }); 
        save(); 
        render(); 
      } 
    }
    
    function saveIntention() {
      var cat = document.getElementById('intentionCategory').value;
      var text = document.getElementById('intentionText').value.trim();
      if (!text) return;
      data.intentions.push({ id: Date.now(), category: cat, text: text, answered: false });
      save(); closeModal('intentionModal'); document.getElementById('intentionText').value = ''; render();
    }
    
    function toggleIntention(id) { data.intentions = data.intentions.map(function(i) { if (i.id === id) i.answered = !i.answered; return i; }); save(); render(); }
    function deleteIntention(id) { event.stopPropagation(); data.intentions = data.intentions.filter(function(i) { return i.id !== id; }); save(); render(); }
    
    function saveJournalEntry() {
      var feeling = document.getElementById('journalFeeling').value.trim();
      var learned = document.getElementById('journalLearned').value.trim();
      var takeaway = document.getElementById('journalTakeaway').value.trim();
      if (!feeling && !learned && !takeaway) { alert('Escribe al menos una reflexi√≥n'); return; }
      
      data.journal.push({
        id: Date.now().toString(),
        date: getTodayKey(),
        timestamp: new Date().toISOString(),
        feeling: feeling,
        learned: learned,
        takeaway: takeaway
      });
      
      save();
      closeModal('journalModal');
      document.getElementById('journalFeeling').value = '';
      document.getElementById('journalLearned').value = '';
      document.getElementById('journalTakeaway').value = '';
      render();
      showStatus('Entrada de diario guardada', 'success');
    }
    
    function deleteJournalEntry(id) {
      if (confirm('¬øEliminar esta entrada del diario?')) {
        data.journal = data.journal.filter(function(j) { return j.id !== id; });
        save(); render();
      }
    }
    
    function addMonthlyGoal() {
      var input = document.getElementById('newGoalInput');
      var catSelect = document.getElementById('newGoalCategory');
      var text = input.value.trim();
      if (!text) return;
      var monthKey = 'month-' + data.currentMonth;
      if (!data.monthlyGoals[monthKey]) data.monthlyGoals[monthKey] = [];
      data.monthlyGoals[monthKey].push({ id: Date.now(), text: text, category: catSelect.value, done: false });
      input.value = ''; save(); render();
    }
    
    function toggleMonthlyGoal(monthKey, id) {
      if (data.monthlyGoals[monthKey]) {
        data.monthlyGoals[monthKey] = data.monthlyGoals[monthKey].map(function(g) { if (g.id === id) g.done = !g.done; return g; });
        save(); render();
      }
    }
    
    function deleteMonthlyGoal(monthKey, id) {
      event.stopPropagation();
      if (data.monthlyGoals[monthKey]) {
        data.monthlyGoals[monthKey] = data.monthlyGoals[monthKey].filter(function(g) { return g.id !== id; });
        save(); render();
      }
    }
    
    function exportData() {
      var blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      var a = document.createElement('a'); a.href = URL.createObjectURL(blob);
      a.download = 'planificador-espiritual-' + getTodayKey() + '.json'; a.click();
      showStatus('Datos exportados', 'success');
    }
    
    function importData(event) {
      var file = event.target.files[0]; if (!file) return;
      var reader = new FileReader();
      reader.onload = function(e) {
        try { 
          data = JSON.parse(e.target.result); 
          if (!data.readChapters) data.readChapters = []; 
          if (!data.monthlyGoals) data.monthlyGoals = {};
          if (!data.dailyPrayers) data.dailyPrayers = {};
          if (!data.journal) data.journal = [];
          if (!data.prayerHistory) data.prayerHistory = [];
          save(); render(); showStatus('Datos importados', 'success'); 
        } catch (err) { showStatus('Error al importar', 'error'); }
      };
      reader.readAsText(file);
    }
    
    init();
  </script>
</body>
</html>
